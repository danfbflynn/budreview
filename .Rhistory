xlab("species")+
ggtitle("Germ date vs. species. Local population in gray, continental averages in color")
pdf("figure1b.pdf", width=11, height=8)
print(plot12a)
dev.off()
germinatedsummarygr$location<-5
plot12csumm<-rbind(germinatedsummarygr, germinatedsummarygrloc)
ggplot(plot12asumm, aes(x=sp,y=mean, shape=origin, group=location))+
geom_errorbar(data=subset(plot12csumm, location!="5"), aes(ymin=mean-sem, ymax=mean+sem), width=.4, position=pd, size=.8, alpha=.6) +
geom_point(data=subset(plot12csumm, location!="5"), position=pd, size=3.6, alpha=.6)+
geom_point(data=subset(plot12csumm, location=="5"), aes(color=origin), position=pd, size=4.5, alpha=.8)+
geom_errorbar(data=subset(plot12csumm, location=="5"), aes(ymin=mean-sem, ymax=mean+sem, color=origin), alpha=.8, width=.2, position=pd, size=.8)+
ylab("growth rate (cm/day)")+
xlab("species")+
ggtitle("Germ date vs. species. Local population in gray, continental averages in color")
ggplot(plot12asumm, aes(x=sp,y=mean, shape=origin, group=location))+
geom_errorbar(data=subset(plot12csumm, location!="5"), aes(ymin=mean-sem, ymax=mean+sem), width=.4, position=pd, size=.8, alpha=.6) +
geom_point(data=subset(plot12csumm, location!="5"), position=pd, size=3.6, alpha=.6)+
geom_point(data=subset(plot12csumm, location=="5"), aes(color=origin), position=position_dodge(1), size=4.5, alpha=.8)+
geom_errorbar(data=subset(plot12csumm, location=="5"), aes(ymin=mean-sem, ymax=mean+sem, color=origin), alpha=.8, width=.2, position=pd, size=.8)+
ylab("growth rate (cm/day)")+
xlab("species")+
ggtitle("Germ date vs. species. Local population in gray, continental averages in color")
ggplot(plot12asumm, aes(x=sp,y=mean, shape=origin, group=location))+
geom_errorbar(data=subset(plot12csumm, location!="5"), aes(ymin=mean-sem, ymax=mean+sem), width=.4, position=pd, size=.8, alpha=.6) +
geom_point(data=subset(plot12csumm, location!="5"), position=pd, size=3.6, alpha=.6)+
geom_point(data=subset(plot12csumm, location=="5"), aes(color=origin), position=pd, size=4.5, alpha=.8)+
geom_errorbar(data=subset(plot12csumm, location=="5"), aes(ymin=mean-sem, ymax=mean+sem, color=origin), alpha=.8, width=.2, position=pd, size=1)+
ylab("growth rate (cm/day)")+
xlab("species")+
ggtitle("Germ date vs. species. Local population in gray, continental averages in color")
pdf("figure1c.pdf", height=8, width=11)
plot12a <-ggplot(plot12asumm, aes(x=sp,y=mean, shape=origin, group=location))+
geom_errorbar(data=subset(plot12csumm, location!="5"), aes(ymin=mean-sem, ymax=mean+sem), width=.4, position=pd, size=.8, alpha=.6) +
geom_point(data=subset(plot12csumm, location!="5"), position=pd, size=3.6, alpha=.6)+
geom_point(data=subset(plot12csumm, location=="5"), aes(color=origin), position=pd, size=4.5, alpha=.8)+
geom_errorbar(data=subset(plot12csumm, location=="5"), aes(ymin=mean-sem, ymax=mean+sem, color=origin), alpha=.8, width=.2, position=pd, size=1)+
ylab("growth rate (cm/day)")+
xlab("species")+
ggtitle("Germ date vs. species. Local population in gray, continental averages in color")
print(plot12a)
dev.off()
dev.off()
germindsummarys<-
ddply(subset(germs, sp!="PLAMED" & sp!="PLACOR"), c( "uniqind", "origin" , "sp"), summarise,
mean=mean(germinated), sd=sd(germinated),
cv=sd(germinated)/mean(germinated))
germindsummarygr<-
ddply(hlms, c( "uniqind", "origin" , "sp"), summarise,
mean=mean(gr), sd=sd(gr),
cv=sd(gr)/mean(gr))
germindsummarydate<-
ddply(subset(germsn, sp!="PLAMED" & sp!="PLACOR"), c( "uniqind", "origin" , "sp"), summarise,
mean=mean(daysfromstart), sd=sd(daysfromstart),
cv=sd(daysfromstart)/mean(daysfromstart))
germsummarysp<-
ddply(subset(germindsummarys, cv!="NaN"), c("origin" , "sp" ), summarise,
mean=mean(cv), sd=sd(cv),
sem=sd(cv)/sqrt(length(cv)))
germsummarygrp<-
ddply(subset(germindsummarygr, cv!="NaN"), c( "origin" , "sp"), summarise,
mean=mean(cv), sd=sd(cv),
sem=sd(cv)/sqrt(length(cv)))
germsummarydatep<-
ddply(subset(germindsummarydate, cv!="NaN"), c("origin" , "sp"), summarise,
mean=mean(cv), sd=sd(cv),
sem=sd(cv)/sqrt(length(cv)))
pdf("plasticity.pdf")
plastica<-ggplot(germsummarydatep, aes(x=as.factor(sp),y=(mean), color=origin))+
geom_errorbar(aes(ymin=mean-sem, ymax=mean+sem), width=.4, position=pd, size=.8) +
geom_point(size=3, alhpa=.2, position=pd)+
geom_line(size=.6) +
ylab("mean coefficient of Variation of individual germ date")+
xlab("species")+
ggtitle("mean coef of variation of germ date vs. species by continent")
print(plastica)
plasticb<-ggplot(germsummarysp, aes(x=as.factor(sp),y=(mean), color=origin))+
geom_errorbar(aes(ymin=mean-sem, ymax=mean+sem), width=.4, position=pd, size=.8) +
geom_point(size=3, alhpa=.2, position=pd)+
geom_line(size=.6) +
ylab("mean coefficient of Variation of individual percent germination")+
xlab("species")+
ggtitle("mean coef of variation of percent germination vs. species by continent")
print(plasticb)
plasticc<-ggplot(germsummarygrp, aes(x=as.factor(sp),y=(mean), color=origin))+
geom_errorbar(aes(ymin=mean-sem, ymax=mean+sem), width=.4, position=pd, size=.8) +
geom_point(size=3, alhpa=.2, position=pd)+
geom_line(size=.6) +
ylab("mean coefficient of Variation of individual growth rate (cm/day)")+
xlab("species")+
ggtitle("mean coef of variation of growth rate vs. species by continent")
print(plasticc)
dev.off()
plot3a<-ggplot(subset(germinatedsummarydatests, sp!="PLAMED" & sp!="PLACOR"), aes(x=(as.factor(temp)),y=mean, color=origin, group=origin))+
geom_errorbar(aes(ymin=mean-sem, ymax=mean+sem), width=.2, position=pd, size=.8) +
geom_line(size=.6) +geom_point(position=pd, size=1.6)+
facet_grid(sp~strat)+
ylab("Days to germination")+
xlab("mean temp (C)")+
ggtitle("Germ date vs. temp by continent and strat for each sp")
pdf("figure3.pdf", width=8, height=11)
print(plot3)
print(plot3a)
dev.off()
pdf("figure2.pdf", width=8, height=11)
print(plot3b)
plot3b<-ggplot(subset(germinatedsotsummarys, sp!="PLAMED" & sp!="PLACOR"), aes(x=(as.factor(temp)),y=mean, color=origin, group=origin))+
geom_errorbar(aes(ymin=mean-sem, ymax=mean+sem), width=.2, position=pd, size=.8) +
geom_line(size=.6) +geom_point(position=pd, size=1.6)+
facet_grid(sp~strat)+
ylab("percent germ")+
xlab("mean temp (C)")+
ggtitle("percent germ vs. temp by continent and strat for each sp")
print(plot3b)
dev.off()
plot3c<-ggplot(germinatedsummarygrts, aes(x=(as.factor(temp)),y=mean, color=origin, group=origin))+
geom_errorbar(aes(ymin=mean-sem, ymax=mean+sem), width=.2, position=pd, size=.8) +
geom_line(size=.6) +geom_point(position=pd, size=1.6)+
facet_grid(sp~strat)+
ylab("growth rate (cm/day)")+
xlab("mean temp (C)")+
ggtitle("growth rate vs. temp by continent and strat for each sp")
pdf("figure4.pdf", width=8, height=11)
print(plot3c)
dev.off()
multiplot(plastica, plasticb, plasticc)
plastica<-ggplot(germsummarydatep, aes(x=as.factor(sp),y=(mean), color=origin))+
geom_errorbar(aes(ymin=mean-sem, ymax=mean+sem), width=.4, position=pd, size=.8) +
geom_point(size=3, alhpa=.2, position=pd)+
geom_line(size=.6) +
ylab("mean CV of days to germination")+
xlab("species")+
ggtitle("mean coef of variation of germ date vs. species by continent")
plasticb<-ggplot(germsummarysp, aes(x=as.factor(sp),y=(mean), color=origin))+
geom_errorbar(aes(ymin=mean-sem, ymax=mean+sem), width=.4, position=pd, size=.8) +
geom_point(size=3, alhpa=.2, position=pd)+
geom_line(size=.6) +
ylab("mean CV of percent germination")+
xlab("species")+
ggtitle("mean coef of variation of percent germination vs. species by continent")
plasticc<-ggplot(germsummarygrp, aes(x=as.factor(sp),y=(mean), color=origin))+
geom_errorbar(aes(ymin=mean-sem, ymax=mean+sem), width=.4, position=pd, size=.8) +
geom_point(size=3, alhpa=.2, position=pd)+
geom_line(size=.6) +
ylab("mean CV of growth rate (cm/day)")+
xlab("species")+
ggtitle("mean coef of variation of growth rate vs. species by continent")
plasticc<-ggplot(germsummarygrp, aes(x=as.factor(sp),y=(mean), color=origin))+
geom_errorbar(aes(ymin=mean-sem, ymax=mean+sem), width=.4, position=pd, size=.8) +
geom_point(size=3, alhpa=.2, position=pd)+
geom_line(size=.6) +
ylab("mean CV of growth rate (cm/day)")+
xlab("species")+
ggtitle("(C) mean coef of variation of growth rate vs. species by continent")
plasticb<-ggplot(germsummarysp, aes(x=as.factor(sp),y=(mean), color=origin))+
geom_errorbar(aes(ymin=mean-sem, ymax=mean+sem), width=.4, position=pd, size=.8) +
geom_point(size=3, alhpa=.2, position=pd)+
geom_line(size=.6) +
ylab("mean CV of percent germination")+
xlab("species")+
ggtitle("(A) mean coef of variation of percent germination vs. species by continent")
plastica<-ggplot(germsummarydatep, aes(x=as.factor(sp),y=(mean), color=origin))+
geom_errorbar(aes(ymin=mean-sem, ymax=mean+sem), width=.4, position=pd, size=.8) +
geom_point(size=3, alhpa=.2, position=pd)+
geom_line(size=.6) +
ylab("mean CV of days to germination")+
xlab("species")+
ggtitle(" (B) mean coef of variation of germ date vs. species by continent")
multiplot(plasticb, plastica, plasticc)
pdf("figure5.pdf", width=8, height=11)
multiplot(plasticb, plastica, plasticc)
dev.off()
dev.off()
dev.off()
mf_labeller <- function(var, value){
value <- as.character(value)
if (var=="strat") {
value[value=="30"] <- "30 days"
value[value=="60"]   <- "60 days"
}
(var=="temp") {
value[value=="11.3"] <- "11.3 °C"
value[value=="16"]   <- "16 °C"
value[value=="20.7"]   <- "20.7 °C"
value[value=="25.3"]   <- "25.3 °C"
if
return(value)
}
mf_labeller <- function(var, value){
value <- as.character(value)
if (var=="strat") {
value[value=="30"] <- "30 days"
value[value=="60"]   <- "60 days"
}
if (var=="temp") {
value[value=="11.3"] <- "11.3 °C"
value[value=="16"]   <- "16 °C"
value[value=="20.7"]   <- "20.7 °C"
value[value=="25.3"]   <- "25.3 °C"
}
return(value)
}
species<-unique(gh$sp)
pdf(file="heightbyspecies.pdf")
for(i in 1:length(species)){
a<-ggplot(subset(gh, sp==species[i]), aes(x=(mdaysfromgerm),y=plantheight, color=origin, group=trayloc))+
geom_line(size=.6, alpha=.2) +geom_point(position=pd, size=1.6, alpha=.2)+
geom_smooth(aes(group = origin), size = 1, method = "lm", se = FALSE, alpha=1)+
facet_grid(temp~strat, labeller=mf_labeller)+
ylab("height (cm)")+
xlab("days since germination")+
ggtitle(paste(species[i], " height vs. age by  column=strat(days), row=temp(C)"))
print(a)
#ggsave("heightbyspecies.pdf")
}
dev.off()
pdf(file="supplement.pdf")
for(i in 1:length(species)){
a<-ggplot(subset(gh, sp==species[i]), aes(x=(mdaysfromgerm),y=plantheight, color=origin, group=trayloc))+
geom_line(size=.6, alpha=.2) +geom_point(position=pd, size=1.6, alpha=.2)+
geom_smooth(aes(group = origin), size = 1, method = "lm", se = FALSE, alpha=1)+
facet_grid(temp~strat, labeller=mf_labeller)+
ylab("height (cm)")+
xlab("days since germination")+
ggtitle(paste(species[i], " height vs. age by stratification length and temperature"))
print(a)
#ggsave("heightbyspecies.pdf")
}
dev.off()
modrateliCAPBUR<-lme(germinated~origin*temp*strat, random=~1|location/uniqind, data=subset(germs, sp=="TAROFF" & sp!="PLAMED" & sp!="PLACOR"))
summary(modrateliCAPBUR)
anova(modratliCAPBUR)
anova(modrateliCAPBUR)
modratelCAPBUR<-lme(germinated~origin*temp*strat, random=~1|location, data=subset(germs, sp=="TAROFF" & sp!="PLAMED" & sp!="PLACOR"))
anova(modratelCAPBUR)
modrateiCAPBUR<-lme(germinated~origin*temp*strat, random=~1|uniqind, data=subset(germs, sp=="TAROFF" & sp!="PLAMED" & sp!="PLACOR"))
anova(modrateiCAPBUR)
modrateCAPBUR<-lme(germinated~origin*temp*strat, data=subset(germs, sp=="TAROFF" & sp!="PLAMED" & sp!="PLACOR"))
modrateCAPBUR<-lm(germinated~origin*temp*strat, data=subset(germs, sp=="TAROFF" & sp!="PLAMED" & sp!="PLACOR"))
anova(modrateCAPBUR)
modrateCAPBUR<-lm(germinated~origin*as.factor(temp)*strat, data=subset(germs, sp=="TAROFF" & sp!="PLAMED" & sp!="PLACOR"))
anova(modrateCAPBUR)
modrateCAPBUR<-lm(germinated~origin*temp*strat, data=subset(germs, sp=="TAROFF"))
anova(modrateCAPBUR)
modrateliCAPBUR<-lme(germinated~origin*temp*strat, random=~1|location/uniqind, data=subset(germs, sp=="CAPBUR" & sp!="PLAMED" & sp!="PLACOR"))
anova(modrateliCAPBUR)
summary(modrateliCAPBUR)
library(car)
install.packages("car")
library(car)
library(car)
modrateliCAPBUR<-lme(germinated~origin*temp*strat, random=~1|location/uniqind, data=subset(germs, sp=="CAPBUR" & sp!="PLAMED" & sp!="PLACOR"))
anova.lme(moddateliCAPBUR)
modrateliCAPBURt<-lme(germinated~origin*as.factor(temp)*strat, random=~1|location/uniqind, data=subset(germs, sp=="CAPBUR" & sp!="PLAMED" & sp!="PLACOR"))
anova.lme(moddateliCAPBURt)
anova.lme(modrateliCAPBURt)
anova.lme(modrateliCAPBUR)
modrateliCAPBURlogit<-lme(logit(germinated)~origin*temp*strat, random=~1|location/uniqind, data=subset(germs, sp=="CAPBUR" & sp!="PLAMED" & sp!="PLACOR"))
?lme
modrateliCAPBURlogit<-lme(germinated~origin*temp*strat, random=~1|location/uniqind, family="binomial", data=subset(germs, sp=="CAPBUR" & sp!="PLAMED" & sp!="PLACOR"))
modrateliCAPBURlogit<-lme(germinated~origin*temp*strat, random=~1|location/uniqind, family=binomial, data=subset(germs, sp=="CAPBUR" & sp!="PLAMED" & sp!="PLACOR"))
summary(modrateliCAPBURt)
log(2)
log(0)
moddateliPLALANlog<-lme(log(daysfromstart)~origin*as.factor(temp)*strat, random=~1|location/uniqind, data=subset(germs, germinated==1 & sp=="PLALAN" & sp!="PLAMED" & sp!="PLACOR"))
qqnorm(moddateliPLALAN)
qqnorm(moddateliPLALANlog)
qqnorm(moddateliPLAMAJ, main="normal qq plot for PLAMAJ germ date")
moddateliPLAMAJ<-lme(log(daysfromstart)~origin*as.factor(temp)*strat, random=~1|location/uniqind, data=subset(germs, germinated==1 & sp=="PLAMAJ" & sp!="PLAMED" & sp!="PLACOR"))
qqnorm(moddateliPLAMAJ, main="normal qq plot for PLAMAJ germ date")
moddateliRUMCRI<-lme(log(daysfromstart)~origin*as.factor(temp)*strat, random=~1|location/uniqind, data=subset(germs, germinated==1 & sp=="RUMCRI" & sp!="PLAMED" & sp!="PLACOR"))
qqnorm(moddateliRUMCRI, main="normal qq plot for RUMCRI germ date")
moddateliPLALAN<-lme(log(daysfromstart)~origin*as.factor(temp)*strat, random=~1|location/uniqind, data=subset(germs, germinated==1 & sp=="PLALAN" & sp!="PLAMED" & sp!="PLACOR"))
moddateliPLAMAJ<-lme(log(daysfromstart)~origin*as.factor(temp)*strat, random=~1|location/uniqind, data=subset(germs, germinated==1 & sp=="PLAMAJ" & sp!="PLAMED" & sp!="PLACOR"))
moddateliRUMCRI<-lme(log(daysfromstart)~origin*as.factor(temp)*strat, random=~1|location/uniqind, data=subset(germs, germinated==1 & sp=="RUMCRI" & sp!="PLAMED" & sp!="PLACOR"))
moddateliDACGLO<-lme(log(daysfromstart)~origin*as.factor(temp)*strat, random=~1|location/uniqind, data=subset(germs, germinated==1 & sp=="DACGLO" & sp!="PLAMED" & sp!="PLACOR"))
moddateliCAPBUR<-lme(log(daysfromstart)~origin*as.factor(temp)*strat, random=~1|location/uniqind, data=subset(germs, germinated==1 & sp=="CAPBUR" & sp!="PLAMED" & sp!="PLACOR"))
moddateliCHEMAJ<-lme(log(daysfromstart)~origin*as.factor(temp)*strat, random=~1|location/uniqind, data=subset(germs, germinated==1 & sp=="CHEMAJ" & sp!="PLAMED" & sp!="PLACOR"))
moddateliPLALAN<-lme(log(daysfromstart)~origin*as.factor(temp)*strat, random=~1|location/uniqind, data=subset(germs, germinated==1 & sp=="PLALAN" & sp!="PLAMED" & sp!="PLACOR"))
moddateliPLAMAJ<-lme(log(daysfromstart)~origin*as.factor(temp)*strat, random=~1|location/uniqind, data=subset(germs, germinated==1 & sp=="PLAMAJ" & sp!="PLAMED" & sp!="PLACOR"))
moddateliRUMCRI<-lme(log(daysfromstart)~origin*as.factor(temp)*strat, random=~1|location/uniqind, data=subset(germs, germinated==1 & sp=="RUMCRI" & sp!="PLAMED" & sp!="PLACOR"))
moddateliDACGLO<-lme(log(daysfromstart)~origin*as.factor(temp)*strat, random=~1|location/uniqind, data=subset(germs, germinated==1 & sp=="DACGLO" & sp!="PLAMED" & sp!="PLACOR"))
moddateliCAPBUR<-lme(log(daysfromstart)~origin*as.factor(temp)*strat, random=~1|location/uniqind, data=subset(germs, germinated==1 & sp=="CAPBUR" & sp!="PLAMED" & sp!="PLACOR"))
moddateliCHEMAJ<-lme(log(daysfromstart)~origin*as.factor(temp)*strat, random=~1|location/uniqind, data=subset(germs, germinated==1 & sp=="CHEMAJ" & sp!="PLAMED" & sp!="PLACOR"))
moddateliTAROFF<-lme(log(daysfromstart)~origin*as.factor(temp)*strat, random=~1|location/uniqind, data=subset(germs, germinated==1 & sp=="TAROFF" & sp!="PLAMED" & sp!="PLACOR"))
moddateliCAPBUR<-lme(daysfromstart~origin*as.factor(temp)*strat, random=~1|location/uniqind, data=subset(germs, germinated==1 & sp=="CAPBUR" & sp!="PLAMED" & sp!="PLACOR"))
moddateliCAPBUR<-lme(daysfromstart~origin*temp*strat, random=~1|location/uniqind, data=subset(germs, germinated==1 & sp=="CAPBUR" & sp!="PLAMED" & sp!="PLACOR"))
moddateliCAPBUR<-lme(log(daysfromstart)~origin*temp*strat, random=~1|location/uniqind, data=subset(germs, germinated==1 & sp=="CAPBUR" & sp!="PLAMED" & sp!="PLACOR"))
qqnorm(moddateliPLALAN, main="normal qq plot for PLALAN germ date")
qqnorm(moddateliPLAMAJ, main="normal qq plot for PLAMAJ germ date")
qqnorm(moddateliCAPBUR, main="normal qq plot for CAPBUR germ date")
qqnorm(moddateliCHEMAJ, main="normal qq plot for CHEMAJ germ date")
qqnorm(moddateliRUMCRI, main="normal qq plot for RUMCRI germ date")
qqnorm(moddateliTAROFF, main="normal qq plot for TAROFF germ date")
qqnorm(moddateliDACGLO, main="normal qq plot for DACGLO germ date")
subset(germs, germinated==1 & sp=="CAPBUR" & sp!="PLAMED" & sp!="PLACOR"))
subset(germs, germinated==1 & sp=="CAPBUR" & sp!="PLAMED" & sp!="PLACOR")
cbsubset<-subset(germs, germinated==1 & sp=="CAPBUR" & sp!="PLAMED" & sp!="PLACOR"))
cbsubset<-subset(germs, germinated==1 & sp=="CAPBUR" & sp!="PLAMED" & sp!="PLACOR")
View(cbsubset)
cbsubset$temp=as.factor
cbsubset$temp=as.factor(temp)
cbsubset$temp=as.factor(cbsubset$temp)
typeof(cbsubset$temp)
cbsubset$temp<-as.factor(cbsubset$temp)
typeof(cbsubset$temp)
as.factor(cbsubset$temp)
typoef(cbsubset$temp)
typeof(cbsubset$temp)
cbsubset$tempf<-as.factor(cbsubset$temp)
typeof(cbsubset$tempf)
cbsubset$temp[5]
moddateliCAPBUR<-lme(log(daysfromstart)~origin*temp*strat, random=~1|location/uniqind, data=subset(germs, germinated==1 & sp=="CAPBUR" & sp!="PLAMED" & sp!="PLACOR"))
moddateliCAPBUR<-lme(log(daysfromstart)~origin*as.factor(temp)*strat, random=~1|location/uniqind, data=subset(germs, germinated==1 & sp=="CAPBUR" & sp!="PLAMED" & sp!="PLACOR"))
print(unique(cbsubset$temp)
)
moddateliCAPBUR<-lme(log(daysfromstart)~origin*(temp)*strat, random=~1|location/uniqind, data=subset(germs, germinated==1 & sp=="CAPBUR" & sp!="PLAMED" & sp!="PLACOR"))
moddateliCAPBUR<-lme(log(daysfromstart)~origin*as.factor(temp)*strat, random=~1|location/uniqind, data=subset(germs, germinated==1 & sp=="CAPBUR" & sp!="PLAMED" & sp!="PLACOR"))
moddateliCAPBUR<-lme(log(daysfromstart)~origin*tempf*strat, random=~1|location/uniqind, data=cbsubset)
moddateliCAPBUR<-lme(log(daysfromstart)~origin*temp*strat, random=~1|location/uniqind, data=cbsubset)
moddateliCAPBUR<-lme(log(daysfromstart)~origin*as.factor(temp)*strat, random=~1|uniqind, data=subset(germs, germinated==1 & sp=="CAPBUR" & sp!="PLAMED" & sp!="PLACOR"))
moddateliCAPBUR<-lme(log(daysfromstart)~origin*as.factor(temp)*strat, random=~1|location, data=subset(germs, germinated==1 & sp=="CAPBUR" & sp!="PLAMED" & sp!="PLACOR"))
moddateliCAPBUR<-lme(log(daysfromstart)~origin*as.factor(temp), random=~1|location/uniqind, data=subset(germs, germinated==1 & sp=="CAPBUR" & sp!="PLAMED" & sp!="PLACOR"))
moddateliCAPBUR<-lme(log(daysfromstart)~origin*as.factor(temp)*strat, random=~1|location/uniqind, data=subset(germs, germinated==1 & sp=="CAPBUR" & sp!="PLAMED" & sp!="PLACOR"))
subset(germs, sp="CAPBUR", temp="11")
subset(germs, sp="CAPBUR" & temp="11")
subset(germs, sp="CAPBUR" & temp=="11")
subset(germs, sp="CAPBUR" && temp=="11")
cbsubsetn<-subset(germs, strat="60" & origin="USA" & temp="11.3" & sp=="CAPBUR" & sp!="PLAMED" & sp!="PLACOR")
cbsubsetn<-subset(germs, strat=="60" & origin=="USA" & temp=="11.3" & sp=="CAPBUR" & sp!="PLAMED" & sp!="PLACOR")
View(subsetn)
View(cbsubsetn)
modgrowthsliCHEMAJ<-lme(gr~origin*as.factor(temp)*strat, random=~1|location/uniqind, data=subset(hlms, sp=="CHEMAJ"))
moddateliCAPBUR<-lme(log(daysfromstart)~origin*as.factor(temp)*strat, random=~1|location/uniqind, data=subset(germs, germinated==1 & sp=="CAPBUR" & sp!="PLAMED" & sp!="PLACOR"))
ggplot(plot12bsumm, aes(x=sp,y=mean, group=location, shape=origin))+
geom_errorbar(data=subset(plot12bsumm, location!="5"),aes(ymin=mean-sem, ymax=mean+sem), width=.4, position=pd, size=.8, alpha=.4) +
geom_point(data=subset(plot12bsumm, location!="5"), position=pd, size=3.6, alpha=.4)+
geom_point(data=subset(plot12bsumm, location=="5"), aes(color=origin), position=pd, size=4.5)+
geom_errorbar(data=subset(plot12bsumm, location=="5"), aes(ymin=mean-sem, ymax=mean+sem, color=origin), width=.2, position=pd, size=1.5)+
ylab("Percent germination")+
xlab("Species")
plot12b <-ggplot(plot12bsumm, aes(x=sp,y=mean, group=location, shape=origin))+
geom_errorbar(data=subset(plot12bsumm, location!="5"),aes(ymin=mean-sem, ymax=mean+sem), width=.4, position=pd, size=.8, alpha=.4) +
geom_point(data=subset(plot12bsumm, location!="5"), position=pd, size=3.6, alpha=.4)+
geom_point(data=subset(plot12bsumm, location=="5"), aes(color=origin), position=pd, size=4.5)+
geom_errorbar(data=subset(plot12bsumm, location=="5"), aes(ymin=mean-sem, ymax=mean+sem, color=origin), width=.2, position=pd, size=1.5)+
ylab("Percent germination")+
xlab("Species")
#ggtitle("percent germination vs. species. Local populations in gray, continental mean in color")
pdf("figure1a.pdf", width=11, height=8)
print(plot12b)
dev.off()
ggplot(plot12asumm, aes(x=sp,y=mean, shape=origin, group=location))+
geom_errorbar(data=subset(plot12asumm, location!="5"), aes(ymin=mean-sem, ymax=mean+sem), width=.4, position=pd, size=.8, alpha=.4) +
geom_point(data=subset(plot12asumm, location!="5"), position=pd, size=3.6, alpha=.6)+
geom_point(data=subset(plot12asumm, location=="5"), aes(color=origin), position=pd, size=4.5, alpha=.4)+
geom_errorbar(data=subset(plot12asumm, location=="5"), aes(ymin=mean-sem, ymax=mean+sem, color=origin), alpha=.8, width=.2, position=pd, size=.8)+
ylab("Days since end of stratification")+
xlab("Species")
ggplot(plot12asumm, aes(x=sp,y=mean, shape=origin, group=location))+
geom_errorbar(data=subset(plot12asumm, location!="5"), aes(ymin=mean-sem, ymax=mean+sem), width=.4, position=pd, size=.8, alpha=.4) +
geom_point(data=subset(plot12asumm, location!="5"), position=pd, size=3.6, alpha=.4)+
geom_point(data=subset(plot12asumm, location=="5"), aes(color=origin), position=pd, size=4.5, alpha=.8)+
geom_errorbar(data=subset(plot12asumm, location=="5"), aes(ymin=mean-sem, ymax=mean+sem, color=origin), alpha=.8, width=.2, position=pd, size=.8)+
ylab("Days since end of stratification")+
xlab("Species")
#ggtitle("Germ date vs. species. Local population in gray, continental averages in color")
plot12a <-ggplot(plot12asumm, aes(x=sp,y=mean, shape=origin, group=location))+
geom_errorbar(data=subset(plot12asumm, location!="5"), aes(ymin=mean-sem, ymax=mean+sem), width=.4, position=pd, size=.8, alpha=.4) +
geom_point(data=subset(plot12asumm, location!="5"), position=pd, size=3.6, alpha=.4)+
geom_point(data=subset(plot12asumm, location=="5"), aes(color=origin), position=pd, size=4.5, alpha=.8)+
geom_errorbar(data=subset(plot12asumm, location=="5"), aes(ymin=mean-sem, ymax=mean+sem, color=origin), alpha=.8, width=.2, position=pd, size=.8)+
ylab("Days since end of stratification")+
xlab("Species")
#ggtitle("Germ date vs. species. Local population in gray, continental averages in color")
pdf("figure1b.pdf", width=11, height=8)
print(plot12a)
dev.off()
dev.off()
modrateliPLALANr<-lmer(germinated~origin*temp*strat, random=~1|location/uniqind, data=subset(germs, sp=="PLALAN" & sp!="PLAMED" & sp!="PLACOR"))
modrateliPLALANr<-lmer(germinated~origin*temp*strat+(1|location/uniqind, data=subset(germs, sp=="PLALAN" & sp!="PLAMED" & sp!="PLACOR"))
modrateliPLALANr<-lmer(germinated~origin*temp*strat+(1|location/uniqind) data=subset(germs, sp=="PLALAN" & sp!="PLAMED" & sp!="PLACOR"))
modrateliPLALANr<-lmer(germinated~origin*temp*strat+(1|location/uniqind), data=subset(germs, sp=="PLALAN" & sp!="PLAMED" & sp!="PLACOR"))
library(lmertest)
install.packages(lmertest)
install.packages("lmerTest")
install.packages("lmerTest")
install.packages("lmerTest")
install.packages("lmerTest")
library(lmerTest)
anova(modrateliPLALANr)
anova(modrateliPLALAN)
if(requireNamespace("pbkrtest", quietly = TRUE))
lkjlfja
modrateliPLALAN<-lme(germinated~origin*temp*strat, random=~1|location/uniqind, data=subset(germs, sp=="PLALAN" & sp!="PLAMED" & sp!="PLACOR"))
library(ggplot2)
library(nlme)
library(plyr)
library(reshape2)
library(Rmisc)
library(lme4)
library(scales)
library(nlme)
## point to files on computer
setwd("C:/Users/Harold/Documents/github/eysterthesis")
library(lme4)
library(lmerTest)
modrateliPLALAN<-lme(germinated~origin*temp*strat, random=~1|location/uniqind, data=subset(germs, sp=="PLALAN" & sp!="PLAMED" & sp!="PLACOR"))
modrateliPLALANr<-lmer(germinated~origin*temp*strat+(1|location/uniqind), data=subset(germs, sp=="PLALAN" & sp!="PLAMED" & sp!="PLACOR"))
anova(modrateliPLALANr)
anova(modrateliPLALAN)
anova(modrateliPLALANr, ddf = "Kenward-Roger")
anova(modrateliPLALANr, ddf="lme4")
anova(modrateliPLALAN)
anova(modrateliPLALANr, ddf = "Kenward-Roger", type=1)
anova(modrateliPLALANr, type=1)
anova(modrateliPLALANr, ddf = "Kenward-Roger", type=2)
anova(modrateliPLALANr, ddf = "Kenward-Roger", type=3)
anova(modrateliPLALANr, type=1)
anova(modrateliPLALANr, ddf = "Kenward-Roger", type=1)
anova(modrateliPLALAN)
modrateliPLALANrb<-lmer(germinated~origin*temp*strat+(1|location/uniqind), family=binomial, data=subset(germs, sp=="PLALAN" & sp!="PLAMED" & sp!="PLACOR"))
anova(modrateliPLALANr, ddf = "Kenward-Roger", type=1)
anova(modrateliPLALANrb, ddf = "Kenward-Roger", type=1)
modrateliPLALANrb<-lmer(germinated~origin*temp*strat+(1|location/uniqind), binomial, data=subset(germs, sp=="PLALAN" & sp!="PLAMED" & sp!="PLACOR"))
anova(modrateliPLALAN)
anova(modrateliPLALAN, type=1)
modrateliPLALANrb<-glmer(germinated~origin*temp*strat+(1|location/uniqind), family=binomial, data=subset(germs, sp=="PLALAN" & sp!="PLAMED" & sp!="PLACOR"))
modrateliPLALANrb<-glmer(germinated~origin*temp*strat+(1|location/uniqind), family=binomial, data=subset(germs, sp=="DACGLO" & sp!="PLAMED" & sp!="PLACOR"))
summary(modrateliPLALANrb)
modrateliPLALANrb<-lmer(germinated~origin*temp*strat+(1|location/uniqind), family=binomial(link="logit"), data=subset(germs, sp=="DACGLO" & sp!="PLAMED" & sp!="PLACOR"))
modrateliPLALANrb<-glmer(germinated~origin*temp*strat+(1|location/uniqind), family=binomial(link="logit"), data=subset(germs, sp=="DACGLO" & sp!="PLAMED" & sp!="PLACOR"))
anova(modrateliPLALANrb, ddf = "Kenward-Roger", type=1)
modrateliPLALANrb<-glmer(germinated~origin*temp*strat+(1|location/uniqind), family=binomial(link="logit"), data=subset(germs, sp=="DACGLO" & sp!="PLAMED" & sp!="PLACOR"))
modrateliPLALANrb<-lmer(germinated~origin*temp*strat+(1|location/uniqind), family=binomial(link="logit"), data=subset(germs, sp=="DACGLO" & sp!="PLAMED" & sp!="PLACOR"))
detach()
anova(modrateliPLALANrb, ddf = "Kenward-Roger", type=1)
library(lmerTest)
detach()
modrateliPLALANrb<-lmer(germinated~origin*temp*strat+(1|location/uniqind), family=binomial(link="logit"), data=subset(germs, sp=="DACGLO" & sp!="PLAMED" & sp!="PLACOR"))
detach(package:lmerTest)
modrateliPLALANrb<-lmer(germinated~origin*temp*strat+(1|location/uniqind), family=binomial(link="logit"), data=subset(germs, sp=="DACGLO" & sp!="PLAMED" & sp!="PLACOR"))
modrateliPLALANrb<-lmer(germinated~origin*temp*strat+(1|location/uniqind), family=binomial(link="logit"), data=subset(germs, sp=="PLALAN" & sp!="PLAMED" & sp!="PLACOR"))
summary(modrateliPLALANrb)
modrateliPLALANrb<-lmer(germinated~origin*temp*strat+(1|location/uniqind), family=binomial(link="logit"), data=subset(germs, sp=="PLALAN" & sp!="PLAMED" & sp!="PLACOR"))
summary(modrateliPLALANrb)
modrateliPLALANrb<-lmer(germinated~origin*temp*strat+(1|location/uniqind),  data=subset(germs, sp=="PLALAN" & sp!="PLAMED" & sp!="PLACOR"))
summary(modrateliPLALANrb)
anova(modrateliPLALANrb)
typeof(anova.glm)
anova(modrateliPLALANrb)
anova(modrateliPLALAN)
modrateliPLALAN<-lme(germinated~origin*temp*strat, random=~1|location/uniqind, data=subset(germs, sp=="PLALAN" & sp!="PLAMED" & sp!="PLACOR"))
anova(modrateliPLALAN)
anova(modrateliPLALANrb)
modrateliPLALANrb<-lmer(germinated~origin*temp*strat+(1|location/uniqind), family=binomial(link="logit"), data=subset(germs, sp=="PLALAN" & sp!="PLAMED" & sp!="PLACOR"))
anova(modrateliPLALANrb)
anova(modrateliPLALAN)
modrateliPLALANrb<-lmer(germinated~origin*temp*strat+(1|location/uniqind), family=binomial(link="logit"), data=subset(germs, sp=="PLALAN" & sp!="PLAMED" & sp!="PLACOR"))
anova(modrateliPLALANrb)
anova(modrateliPLALAN)
summary(.glm)
summary.glm
glmlist
write.csv(germs)
write.csv(germs, file="germs.csv")
modrateliPLALANrb<-lmer(germinated~origin*as.factor(temp)*strat+(1|location/uniqind), family=binomial(link="logit"), data=subset(germs, sp=="PLALAN" & sp!="PLAMED" & sp!="PLACOR"))
anova(modrateliPLALANrb)
install.packages("afex")
library(afex)
modrateliPLALANrb<-mixed(germinated~origin*as.factor(temp)*strat+(1|location/uniqind), family=binomial(link="logit"), data=subset(germs, sp=="PLALAN" & sp!="PLAMED" & sp!="PLACOR"))
library(afex)
install.packages("afex")
library(afex)
library(afex)
modrateliPLALANrb<-mixed(germinated~origin*as.factor(temp)*strat+(1|location/uniqind), family=binomial(link="logit"), data=subset(germs, sp=="PLALAN" & sp!="PLAMED" & sp!="PLACOR"))
install.packages("glmmML")
library(glmmML)
intall.packages(glmmpql)
install.packages("MASS")
install.packages("MASS")
library(MASS)
library(MASS)
install.packages("MASS")
install.packages("MASS")
install.packages("MASS")
library(MASS)
modrateliPLALANg<-glmmpql(germinated~origin*as.factor(temp)*strat+(1|location/uniqind), family=binomial(link="logit"), data=subset(germs, sp=="PLALAN" & sp!="PLAMED" & sp!="PLACOR"))
modrateliPLALANg<-glmmPQL(germinated~origin*as.factor(temp)*strat+(1|location/uniqind), family=binomial(link="logit"), data=subset(germs, sp=="PLALAN" & sp!="PLAMED" & sp!="PLACOR"))
modrateliPLALANg<-glmmPQL(germinated~origin*as.factor(temp)*strat+(1|location/uniqind), family=binomial(link="logit"), data=subset(germs, sp=="PLALAN" & sp!="PLAMED" & sp!="PLACOR"))
library(nlme)
modrateliPLALANg<-glmmPQL(germinated~origin*as.factor(temp)*strat+(1|location/uniqind), family=binomial(link="logit"), data=subset(germs, sp=="PLALAN" & sp!="PLAMED" & sp!="PLACOR"))
library(MASS)
detach(package:lme4)
detach(package:ALL)
detach(package:lmeTtest)
detach(package:lmeTest)
detach(package:lmerTest)
detach(package:lme4)
detach(package:nlme)
library(MASS)
install.packages(MASS)
install.packages("MASS")
install.packages("MASS")
install.packages("MASS")
library(MASS)
modrateliPLALANg<-glmmPQL(germinated~origin*as.factor(temp)*strat+(1|location/uniqind), family=binomial(link="logit"), data=subset(germs, sp=="PLALAN" & sp!="PLAMED" & sp!="PLACOR"))
library(MASS)
?MASS
?glmmPQL
summary(glmmPQL(germinated~origin*as.factor(temp)*strat+(1|location/uniqind), family=binomial(link="logit"), data=subset(germs, sp=="PLALAN" & sp!="PLAMED" & sp!="PLACOR")))
library(MASS)
