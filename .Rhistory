germ$germdate <- as.Date(germ$germdate, format="%m/%d/%Y")
germ$doy <- as.numeric(format(germ$germdate, "%j"))
height$measuredate <- as.Date(height$measuredate, format="%m/%d/%Y") #this line doesn't work -- won't save in correct format
#height$heightdate <-format(height$measuredate, "%b/%d/%Y")
germ$daysfromstart <- ifelse(germ$doy<100, (germ$doy)+38, (germ$doy)-327) # use start date of 23 Nov 2015, and account for 2016 vs. 2015 date
#create unique identifiers for each seed
germ$uniqueid<- NA
germ$uniqueid<-do.call(paste, c(germ[c("trayloc", "substrate")], sep=""))
id$uniqueid<- NA
id$uniqueid<-do.call(paste, c(germ[c("trayloc", "substrate")], sep=""))
height$uniqueid<- NA
height$uniqueid<-do.call(paste, c(height[c("trayloc", "substrate")], sep=""))
height$plantheight<-as.numeric(height$plantheight) # make the plant height measurements numerical
#merge the germ and id data frames
germid <- merge(germ,id,by=("uniqueid"))
colnames(germid)[2]<-"trayloc"
colnames(germid)[3]<-"substrate"
germid$substrate.y<-NULL #remove duplicate columns
germid$trayloc.y<-NULL #remove duplicate columns
#create column for continental origin
germid$origin[which(grepl("EU", germid$individual)==TRUE)] <- "Europe"
germid$origin[which(grepl("US", germid$individual)==TRUE)] <- "USA"
germid$location<-do.call(paste, c(germid[c("origin", "location")], sep="--"))
## Assign the treatments an average temp
# 18/8, 22.67/12.67C, 27.33/17.33, and 32/22
germid$temp[germid$temp=="LL"] <- (16*8+18*8)/24
germid$temp[germid$temp=="LM"] <- (16*12.67+23.67*8)/24
germid$temp[germid$temp=="HM"] <- (16*27.33+17.33*8)/24
germid$temp[germid$temp=="HH"] <- (16*22+32*8)/24
germid$temp <- as.numeric(germid$temp)
##adding in a step here to round the average temp since you are likely using it as a factor in your analysis, not a continuous variable##EJF
germid$temp <- round(germid$temp,digits=0)
#add column to for current germ rate, setting germinated seeds to 1, ungerminated to 0
germid$germinated <- germid$doy
germid$germinated[is.na(germid$germinated)==TRUE] <- 0
germid$germinated[germid$germinated>0] <- 1
#subset the data by substrate
germs<-subset(germid, substrate=="Soil", select=uniqueid:germinated) #subset with data from seeds planted in soil
germf<-subset(germid, substrate=="Filter", select=uniqueid:germinated) #subset with data from seeds planted on filter paper
#hist(germs$daysfromstart, breaks=10)
#hist(germf$daysfromstart, breaks=10)
#hist(subset(germid, substrate="Soil", select=daysfromstart), breaks=10 )
#germid$soil[which(grepl("Soil", germid$uniqueid)==TRUE)]<- "10"
#table(germid[which(germid$substrate=="Filter"),],germid$daysfromstart, germid$sp, germid$origin, useNA="always")
table(germs$daysfromstart, germs$sp, useNA="always") #table to view germination date data for soil seeds
table(germf$daysfromstart, germf$sp, useNA="always") #table to view germination date data for filter paper seeds
germcheckf <- table(germf$germinated, germf$sp, useNA="always")
germchecks <-table(germs$germinated, germs$sp, useNA="always")
# calculate percent germinated
percentgermf<-germcheckf[2,]/(germcheckf[1,]+germcheckf[2,]) #percent germinated for filter paper
percentgermf
percentgerms<-germchecks[2,]/(germchecks[1,]+germchecks[2,]) #percent germinated for soil
percentgerms
##Plots!
pd<-position_dodge(.4)
# comparing day of germination for filter/soil and Europe/USA
ggplot(germid,aes(x=sp,y=daysfromstart, fill=substrate))+geom_boxplot() # Compare germination rates between the substrates
ggplot(germid[which(germid$sp!= "PLAMED" & germid$sp!="PLACOR" & germid$substrate=="Soil"),],aes(x=sp,y=daysfromstart, fill=origin))+ylab("Germination Date for Soil")+geom_boxplot() #Compare germination rates between continents for soil plantings
ggplot(germid[which(germid$sp!= "PLAMED" & germid$sp!="PLACOR" & germid$substrate=="Filter"),],aes(x=sp,y=daysfromstart, fill=origin))+ylab("Germination Date for filter")+geom_boxplot() #Compare germination rates between continents for filter plantings
#Comparing congenerics:
ggplot(germid,aes(x=sp,y=daysfromstart, fill=location, colour=origin))+geom_boxplot() #compare day of germination for each species across locations
##calculate germination percents for each species by continent
#for soil:
germinatedsummarys<-
ddply(subset(germs,sp!="PLAMED" & sp!="PLACOR"), c( "origin", "sp" ), summarise,
mean=mean(germinated), sd=sd(germinated),
sem=sd(germinated)/sqrt(length(germinated)))
#for filter:
germinatedsummaryf<-
ddply(subset(germs,sp!="PLAMED" & sp!="PLACOR"), c( "origin", "sp" ), summarise,
mean=mean(germinated), sd=sd(germinated),
sem=sd(germinated)/sqrt(length(germinated)))
plot2b <-ggplot(germinatedsummarys, aes(x=sp,y=mean, color=origin))+
geom_errorbar(aes(ymin=mean-sem, ymax=mean+sem), width=.4, position=pd, size=.8) +
geom_point(position=pd, size=3.6)+
ylab("percent germ")+
xlab("species")+
ggtitle("percent germ vs. species by continent")
##Looking more closely at location
germinatedlocsummarys<-
ddply(subset(germs, sp!="PLAMED", sp!="PLACOR"), c( "location", "origin" , "sp" ), summarise,
mean=mean(germinated), sd=sd(germinated),
sem=sd(germinated)/sqrt(length(germinated)))
#for filter:
germinatedlocsummaryf<-
ddply(subset(germs, sp!="PLAMED", sp!="PLACOR"), c( "location", "origin" , "sp" ), summarise,
mean=mean(germinated), sd=sd(germinated),
sem=sd(germinated)/sqrt(length(germinated)))
#plot of germ day vs. species by populaiton
plot1b <-ggplot(germinatedlocsummarys, aes(x=sp,y=mean, color=location, shape=origin))+
geom_errorbar(aes(ymin=mean-sem, ymax=mean+sem), width=.4, position=pd, size=.8) +
geom_point(position=pd, size=3.6)+
ylab("percent germ")+
xlab("species")+
ggtitle("Percent germination vs. species by population")
germs$treatment<-do.call(paste, c(germs[c("temp", "strat")], sep="_")) #combine strat and temperature into one treatment variable
germf$treatment<-do.call(paste, c(germf[c("temp", "strat")], sep="_")) #combine strat and temperature into one treatment variable
germid$treatment<-do.call(paste, c(germid[c("temp", "strat")], sep="_")) #combine strat and temperature into one treatment variable
germcomps<-subset(germs, sp!="PLAMED" | sp!="PLACOR") #create frame without Europe congenerics
germcompf<-subset(germf, sp!="PLAMED" | sp!="PLACOR") #create frame without Europe congenerics
#creating summaries for treatment and origin for soil:
germinatedsummaryags<-
ddply(germcomps, c( "origin", "treatment"), summarise,
mean=mean(germinated), sd=sd(germinated),
sem=sd(germinated)/sqrt(length(germinated)))
#for filter:
germinatedsummaryagf<-
ddply(germcompf, c( "origin", "treatment"), summarise,
mean=mean(germinated), sd=sd(germinated),
sem=sd(germinated)/sqrt(length(germinated)))
##plot comparing percent germ rates for continents x  treatments
#plot showing germination response to treatments in the soil seeds
ggplot(germinatedsummaryags,aes(x=as.factor(treatment),y=mean, colour=origin))+
xlab("treatment (temp_strat)") + ylab("mean percent germination")+
geom_errorbar(aes(ymin=mean-sem, ymax=mean+sem), width=.4, position=pd, size=.8) +
geom_line() +geom_point(position=pd, size=2.6) + ggtitle("Effect of treatment on percent germination of seeds in soil")
s
spp <- unique(germid$sp)
##new summaries with sp, origin, and treatment
#for soil:
germinatedsotsummarys<-
ddply(germs, c( "sp", "origin", "strat", "temp"), summarise,
mean=mean(germinated), sd=sd(germinated),
sem=sd(germinated)/sqrt(length(germinated)))
#for filter:
germinatedsotsummaryf<-
ddply(germf, c( "sp", "origin", "treatment"), summarise,
mean=mean(germinated), sd=sd(germinated),
sem=sd(germinated)/sqrt(length(germinated)))
plot3b<-ggplot(subset(germinatedsotsummarys, sp!="PLAMED" & sp!="PLACOR"), aes(x=(as.factor(temp)),y=mean, color=origin, group=origin))+
geom_errorbar(aes(ymin=mean-sem, ymax=mean+sem), width=.2, position=pd, size=.8) +
geom_line(size=.6) +geom_point(position=pd, size=1.6)+
facet_grid(sp~strat)+
ylab("percent germ")+
xlab("mean temp (C)")+
ggtitle("percent germ vs. temp by continent and strat for each sp")
germs$uniqind<- NA
germs$uniqind<- do.call(paste, c(germs[c("sp", "individual")], sep="_")) #combine sp and individual to obtain a column for unique individual
germinatedindsummarys<-
ddply(germs, c( "uniqind", "treatment"), summarise,
mean=mean(germinated), sd=sd(germinated),
sem=sd(germinated)/sqrt(length(germinated)))
germsn<-subset(germs, germinated==1) #first subset data to only look at seeds that germinated
#calculations for date of germination across sp by location
germinatedsummarydatesloc<-
ddply(subset(germsn, sp!="PLAMED" & sp!="PLACOR"), c( "origin", "sp", "location"), summarise,
mean=mean(daysfromstart), sd=sd(daysfromstart),
sem=sd(daysfromstart)/sqrt(length(daysfromstart)))
#plot of germ day vs. species by populaiton
plot1a <-ggplot(germinatedsummarydatesloc, aes(x=sp,y=mean, color=location, shape=origin))+
geom_errorbar(aes(ymin=mean-sem, ymax=mean+sem), width=.4, position=pd, size=.8) +
geom_point(position=pd, size=3.6)+
ylab("germ date")+
xlab("species")+
ggtitle("Germ date vs. species by population")
#calculations to collapse population into continent
germinatedsummarydates<-
ddply(subset(germsn, sp!="PLAMED" & sp!="PLACOR"), c( "origin", "sp"), summarise,
mean=mean(daysfromstart), sd=sd(daysfromstart),
sem=sd(daysfromstart)/sqrt(length(daysfromstart)))
#plot for germ day vs. species by continent
plot2a <-ggplot(germinatedsummarydates, aes(x=sp,y=mean, color=origin))+
geom_errorbar(aes(ymin=mean-sem, ymax=mean+sem), width=.4, position=pd, size=.8) +
geom_point(position=pd, size=3.6)+
ylab("germ date")+
xlab("species")+
ggtitle("Germ date vs. species by continent")
#Calculations for date of germination for each species
germinatedsummarydatests<-
ddply(germsn, c( "sp", "origin", "temp" , "strat"), summarise,
mean=mean(daysfromstart), sd=sd(daysfromstart),
sem=sd(daysfromstart)/sqrt(length(daysfromstart)))
#plot for each species germination date against treatment, origin
plot3a<-ggplot(subset(germinatedsummarydatests, sp!="PLAMED" & sp!="PLACOR"), aes(x=(as.factor(temp)),y=mean, color=origin, group=origin))+
geom_errorbar(aes(ymin=mean-sem, ymax=mean+sem), width=.2, position=pd, size=.8) +
geom_line(size=.6) +geom_point(position=pd, size=1.6)+
facet_grid(sp~strat)+
ylab("germ date")+
xlab("mean temp (C)")+
ggtitle("Germ date vs. temp by continent and strat for each sp")
#Now aggregating the species
germinatedsummarydates<-
ddply(subset(germsn, sp!="PLAMED" | sp!="PLACOR"), c( "origin", "treatment"), summarise,
mean=mean(daysfromstart), sd=sd(daysfromstart),
sem=sd(daysfromstart)/sqrt(length(daysfromstart)))
germsheightna <- merge(germs,height,by=("trayloc")) #merging the germination and height data sets. Including non-gemrinating seeds
germsheight<-germsheightna[which(germsheightna$germinated==1),] #removing the seeds that didn't germinate
#data cleaning
germsheight$substrate.y=NULL
germsheight$uniqueid.y=NULL
names(germsheight)[names(germsheight)=="uniqueid.x"] <- "uniqueid"
names(germsheight)[names(germsheight)=="substrate.x"] <- "substrate"
#Relating measure date and start date
germsheight$dom <- as.numeric(format(germsheight$measuredate, "%j"))
germsheight$mdaysfromstart <- ifelse(germsheight$dom<100, (germsheight$dom)+38, (germsheight$dom)-327) # use start date of 23 Nov 2015, and account for 2016 vs. 2015 date
germsheight$mdaysfromgerm <- germsheight$mdaysfromstart-germsheight$daysfromstart #this creates a column for how old the seedling was when measured. Seeds that haven't germinated yet will yeild negative values
ghc<-subset(germsheight, mdaysfromgerm>=0) #subset data to remove false height measurements for seeds that hadn't yet germinated
gh<-subset(ghc, sp!="PLAMED" & sp!="PLACOR" & plantheight!="NA" ) #removing the european congenerics
#plot of plantheight vs. days from germ for all of the seeds
ggplot(gh,aes(x=as.factor(mdaysfromgerm), y=plantheight))+
ylab("plant height for all spp")+
xlab("days since germination")+
geom_boxplot()+
ggtitle("Plant height vs. days since germination")
#Now for one species
ggplot(subset(gh, sp=="RUMCRI"),aes(x=(as.factor(mdaysfromgerm)),y=plantheight, color=trayloc))+
ylab("RUMCRI height")+
xlab("days since germination")+
geom_point()+
geom_smooth(method=lm, aes(group=1))+
ggtitle("RUMCRI height vs. days since germination")
n<-unique(gh$trayloc)
hlm=data.frame(n)
#run a for loop to calculate lm coef for height vs. time
for(i in 1:length(n)){
print(n[i])
hlm$m[i]<-lm(plantheight~mdaysfromgerm, data=subset(gh, trayloc==n[i]))
}
hlm$b <- lapply(strsplit(as.character(hlm$m), ","), "[", 2)  #split the intercept and slope
hlm$b<-gsub("\\)","",as.character(hlm$b)) #remove the paranthesis
hlmn<-subset(hlm, gr!="NA") #removes NA values (i.e. where there is only one height measurment, hence no growth rate could be calulated)
hlm$gr<-as.numeric(hlm$b) #this columm now has the slope coef in numeric form
hlms<-merge(hlmn, germs, by.x=("n"), by.y=("trayloc"), all.y=FALSE)
#print(model$n[model$c<0],) # tests for negative values. Some of the values are negative for plants that didn't grow much, and so do;
#measurment error, they seem to decrease in height. If difference was <1cm, the values were kept in.
germinatedsummarygrloc<-
ddply(hlms, c( "origin", "sp", "location"), summarise,
mean=mean(gr), sd=sd(gr),
sem=sd(gr)/sqrt(length(gr)))
hlmn<-subset(hlm, gr!="NA") #removes NA values (i.e. where there is only one height measurment, hence no growth rate could be calulated)
hlms<-merge(hlmn, germs, by.x=("n"), by.y=("trayloc"), all.y=FALSE)
#print(model$n[model$c<0],) # tests for negative values. Some of the values are negative for plants that didn't grow much, and so do;
#measurment error, they seem to decrease in height. If difference was <1cm, the values were kept in.
germinatedsummarygrloc<-
ddply(hlms, c( "origin", "sp", "location"), summarise,
mean=mean(gr), sd=sd(gr),
sem=sd(gr)/sqrt(length(gr)))
#plot of growth rate vs. species by populaiton
plot1c <-ggplot(germinatedsummarygrloc, aes(x=sp,y=mean, color=location, shape=origin))+
geom_errorbar(aes(ymin=mean-sem, ymax=mean+sem), width=.4, position=pd, size=.8) +
geom_point(position=pd, size=3.6)+
ylab("growth rate")+
xlab("species")+
ggtitle("growth rate vs. species by population")
germinatedsummarygr<-
ddply(hlms, c( "origin", "sp"), summarise,
mean=mean(gr), sd=sd(gr),
sem=sd(gr)/sqrt(length(gr)))
#plot for germ day vs. species by continent
plot2c <-ggplot(germinatedsummarygr, aes(x=sp,y=mean, color=origin))+
geom_errorbar(aes(ymin=mean-sem, ymax=mean+sem), width=.4, position=pd, size=.8) +
geom_point(position=pd, size=3.6)+
ylab("growth rate")+
xlab("species")+
ggtitle("growth rate vs. species by continent")
germinatedsummarygrts<-
ddply(hlms, c( "origin", "sp", "temp", "strat"), summarise,
mean=mean(gr), sd=sd(gr),
sem=sd(gr)/sqrt(length(gr)))
#set up multipanel plot to look at growth rate for each species
plot3c<-ggplot(germinatedsummarygrts, aes(x=(as.factor(temp)),y=mean, color=origin, group=origin))+
geom_errorbar(aes(ymin=mean-sem, ymax=mean+sem), width=.2, position=pd, size=.8) +
geom_line(size=.6) +geom_point(position=pd, size=1.6)+
facet_grid(sp~strat)+
ylab("growth rate")+
xlab("mean temp (C)")+
ggtitle("Germ date vs. temp by continent and strat for each sp")
germinatedsummaryheight<-
ddply(gh, c( "origin", "sp", "temp", "strat" ,"mdaysfromgerm"), summarise,
mean=mean(plantheight), sd=sd(plantheight),
sem=sd(plantheight)/sqrt(length(plantheight)))
germinatedsummaryheight$ots<- do.call(paste,c(germinatedsummaryheight[c("strat", "sp" , "origin", "temp", "mdaysfromgerm")], sep="_"))
hm<-data.frame(germinatedsummaryheight$ots, germinatedsummaryheight$mean)
names(hm)=c("ots", "heightmean")
gh$ots<-do.call(paste, c(gh[c("strat", "sp" ,"origin", "temp", "mdaysfromgerm")], sep="_"))
mgh<-merge(hm, gh, by="ots", all.y=TRUE)
plot1a
?pdf
pdf("test.pdf", paper=letterr )
pdf("test.pdf", width=11, height=8.5 )
print(plot1a)
dev.off()
pdf("test.pdf", width=14, height=8.5 )
pdf("test.pdf", width=11, height=8.5 )
print(plot1b)
print(plot1c)
dev.off()
plot2a
pdf("plot2.pdf", width=11, height=8.5 )
print(plot2a)
print(plot2b)
pring(plot2c)
print(plot2c)
plot3a
dev.off()
pdf("plot1.pdf", width=11, height=8.5 )
print(plot1a)
print(plot1b)
print(plot1c)
dev.off()
print(3a)
print(plot3a)
pdf("plot3.pdf", height=11, width=8.5 )
print(3a)
print(plot3a)
print(plot3b)
print(plot3c)
dev.off()
pdf("plot3.pdf", height=11, width=8.5 )
print(plot3a)
print(plot3b)
print(plot3c)
dev.off()
plot3c<-ggplot(germinatedsummarygrts, aes(x=(as.factor(temp)),y=mean, color=origin, group=origin))+
geom_errorbar(aes(ymin=mean-sem, ymax=mean+sem), width=.2, position=pd, size=.8) +
geom_line(size=.6) +geom_point(position=pd, size=1.6)+
facet_grid(sp~strat)+
ylab("growth rate")+
xlab("mean temp (C)")+
ggtitle("growth rate vs. temp by continent and strat for each sp")
pdf("plot3.pdf", height=11, width=8.5 )
print(plot1a)
dev.off
def.off()
dev.off()
pdf("plot3.pdf", height=11, width=8.5 )
print(plot3a)
print(plot3b)
print(plot3c)
dev.off()
plot4b<-ggplot(subset(mgh, sp=="DACGLO"), aes(x=(mdaysfromgerm),y=plantheight, color=origin, group=trayloc))+
geom_line(size=.6, alpha=.2) +geom_point(position=pd, size=2, alpha=.2)+
#geom_smooth(aes(group = origin), size = 1, method = "lm", se = FALSE, alpha=1)+
geom_line(aes(x=(mdaysfromgerm),y=heightmean, color=origin, group=origin), size=1, alpha=1)+
facet_grid(temp~strat)+
ylab("height (cm)")+
xlab("mdaysfromgerm")+
ggtitle("DACGLO height vs. days since germ  by color=continent, column=strat(days), row=temp(C)")
pdf("plot4_mean.pdf", width=8.5, length=11)
pdf("plot4_mean.pdf", width=8.5, height=11)
print(plot4b)
dev.off()
mghdacglo<-subset(mgh, sp="DACGLO" & strat="60", and temp=25)
mghdacglo<-subset(mgh, sp="DACGLO" & strat="60"& temp=25)
mghdacglo<-subset(mgh, sp=="DACGLO" & strat=="60"& temp==25)
View(mghdacglo)
mghplalan<-subset(mgh, sp=="PLALAN" & strat=="30"& temp==25)
View(mghplalan)
range(mghplalan$plantheight)
dev.off()
print(mghplalan$trayloc[mghplalan$plantheight>15])
print(mgh$trayloc[mgh$plantheight>5 & sp=="PLAMAJ" & strat=="30" & temp=="24"])
print(mgh$trayloc[mgh$plantheight>5 & mgh$sp=="PLAMAJ" & mgh$strat=="30" & mgh$temp=="24"])
print(mgh$trayloc[mgh$plantheight>5 & mgh$sp=="PLAMAJ" & mgh$strat=="60" & mgh$temp=="11"])
print(mgh$trayloc[mgh$plantheight==5 & mgh$sp=="PLAMAJ" & mgh$strat=="60" & mgh$temp=="11"])
print(mgh$trayloc[mgh$plantheight==5 & mgh$sp=="PLAMAJ" & mgh$strat=="60" & mgh$temp=="11" & mgh$origin=-"USA"])
print(mgh$trayloc[mgh$plantheight==5 & mgh$sp=="PLAMAJ" & mgh$strat=="60" & mgh$temp=="11" & mgh$origin=="USA"])
print(mgh$trayloc[mgh$plantheight<4 & mgh$sp=="CHEMAJ" & mgh$strat=="60" & mgh$temp=="24" & mgh$origin=="USA" & mgh$mdaysfromgerm>40])
mghcapbur<-subset(mgh, sp=="CAPBUR" & strat=="30"& temp==25)
View(mghcapbur)
#print(model$n[model$c<0],) # tests for negative values. Some of the values are negative for plants that didn't grow much, and so do;
#measurment error, they seem to decrease in height. If difference was <1cm, the values were kept in.
height<- read.csv("input/height_data_2-13-16.csv", header=TRUE) #Read the height file
names(height)<- c("trayloc", "substrate", "measuredate", "plantheight" )
height$measuredate <- as.Date(height$measuredate, format="%m/%d/%Y") #this line doesn't work -- won't save in correct format
height$uniqueid<- NA
height$uniqueid<-do.call(paste, c(height[c("trayloc", "substrate")], sep=""))
height$plantheight<-as.numeric(height$plantheight) # make the plant height measurements numerical
germsheightna <- merge(germs,height,by=("trayloc")) #merging the germination and height data sets. Including non-gemrinating seeds
germsheight<-germsheightna[which(germsheightna$germinated==1),] #removing the seeds that didn't germinate
#data cleaning
germsheight$substrate.y=NULL
germsheight$uniqueid.y=NULL
names(germsheight)[names(germsheight)=="uniqueid.x"] <- "uniqueid"
names(germsheight)[names(germsheight)=="substrate.x"] <- "substrate"
#Relating measure date and start date
germsheight$dom <- as.numeric(format(germsheight$measuredate, "%j"))
germsheight$mdaysfromstart <- ifelse(germsheight$dom<100, (germsheight$dom)+38, (germsheight$dom)-327) # use start date of 23 Nov 2015, and account for 2016 vs. 2015 date
germsheight$mdaysfromgerm <- germsheight$mdaysfromstart-germsheight$daysfromstart #this creates a column for how old the seedling was when measured. Seeds that haven't germinated yet will yeild negative values
ghc<-subset(germsheight, mdaysfromgerm>=0) #subset data to remove false height measurements for seeds that hadn't yet germinated
gh<-subset(ghc, sp!="PLAMED" & sp!="PLACOR" & plantheight!="NA" ) #removing the european congenerics
n<-unique(gh$trayloc)
hlm=data.frame(n)
#run a for loop to calculate lm coef for height vs. time
for(i in 1:length(n)){
print(n[i])
hlm$m[i]<-lm(plantheight~mdaysfromgerm, data=subset(gh, trayloc==n[i]))
}
hlm$b <- lapply(strsplit(as.character(hlm$m), ","), "[", 2)  #split the intercept and slope
hlm$b<-gsub("\\)","",as.character(hlm$b)) #remove the paranthesis
hlm$gr<-as.numeric(hlm$b) #this columm now has the slope coef in numeric form
hlmn<-subset(hlm, gr!="NA") #removes NA values (i.e. where there is only one height measurment, hence no growth rate could be calulated)
hlms<-merge(hlmn, germs, by.x=("n"), by.y=("trayloc"), all.y=FALSE)
#print(model$n[model$c<0],) # tests for negative values. Some of the values are negative for plants that didn't grow much, and so do;
#measurment error, they seem to decrease in height. If difference was <1cm, the values were kept in.
germinatedsummarygrloc<-
ddply(hlms, c( "origin", "sp", "location"), summarise,
mean=mean(gr), sd=sd(gr),
sem=sd(gr)/sqrt(length(gr)))
plot1c <-ggplot(germinatedsummarygrloc, aes(x=sp,y=mean, color=location, shape=origin))+
geom_errorbar(aes(ymin=mean-sem, ymax=mean+sem), width=.4, position=pd, size=.8) +
geom_point(position=pd, size=3.6)+
ylab("growth rate")+
xlab("species")+
ggtitle("growth rate vs. species by population")
germinatedsummarygr<-
ddply(hlms, c( "origin", "sp"), summarise,
mean=mean(gr), sd=sd(gr),
sem=sd(gr)/sqrt(length(gr)))
plot2c <-ggplot(germinatedsummarygr, aes(x=sp,y=mean, color=origin))+
geom_errorbar(aes(ymin=mean-sem, ymax=mean+sem), width=.4, position=pd, size=.8) +
geom_point(position=pd, size=3.6)+
ylab("growth rate")+
xlab("species")+
ggtitle("growth rate vs. species by continent")
germinatedsummarygrts<-
ddply(hlms, c( "origin", "sp", "temp", "strat"), summarise,
mean=mean(gr), sd=sd(gr),
sem=sd(gr)/sqrt(length(gr)))
plot3c<-ggplot(germinatedsummarygrts, aes(x=(as.factor(temp)),y=mean, color=origin, group=origin))+
geom_errorbar(aes(ymin=mean-sem, ymax=mean+sem), width=.2, position=pd, size=.8) +
geom_line(size=.6) +geom_point(position=pd, size=1.6)+
facet_grid(sp~strat)+
ylab("growth rate")+
xlab("mean temp (C)")+
ggtitle("growth rate vs. temp by continent and strat for each sp")
germinatedsummaryheight<-
ddply(gh, c( "origin", "sp", "temp", "strat" ,"mdaysfromgerm"), summarise,
mean=mean(plantheight), sd=sd(plantheight),
sem=sd(plantheight)/sqrt(length(plantheight)))
germinatedsummaryheight$ots<- do.call(paste,c(germinatedsummaryheight[c("strat", "sp" , "origin", "temp", "mdaysfromgerm")], sep="_"))
hm<-data.frame(germinatedsummaryheight$ots, germinatedsummaryheight$mean)
names(hm)=c("ots", "heightmean")
gh$ots<-do.call(paste, c(gh[c("strat", "sp" ,"origin", "temp", "mdaysfromgerm")], sep="_"))
mgh<-merge(hm, gh, by="ots", all.y=TRUE)
species<-unique(gh$sp)
pdf(file="heightbyspecies.pdf")
for(i in 1:length(species)){
a<-ggplot(subset(gh, sp==species[i]), aes(x=(mdaysfromgerm),y=plantheight, color=origin, group=trayloc))+
geom_line(size=.6, alpha=.2) +geom_point(position=pd, size=1.6, alpha=.2)+
geom_smooth(aes(group = origin), size = 1, method = "lm", se = FALSE, alpha=1)+
facet_grid(temp~strat)+
ylab("height (cm)")+
xlab("days since germination")+
ggtitle(paste(species[i], " height vs. age by  column=strat(days), row=temp(C)"))
print(a)
#ggsave("heightbyspecies.pdf")
}
dev.off()
pdf("plot4_mean.pdf", width=8.5, height=11)
print(plot4b)
dev.off()
plot4b<-ggplot(subset(mgh, sp=="DACGLO"), aes(x=(mdaysfromgerm),y=plantheight, color=origin, group=trayloc))+
geom_line(size=.6, alpha=.2) +geom_point(position=pd, size=2, alpha=.2)+
#geom_smooth(aes(group = origin), size = 1, method = "lm", se = FALSE, alpha=1)+
geom_line(aes(x=(mdaysfromgerm),y=heightmean, color=origin, group=origin), size=1, alpha=1)+
facet_grid(temp~strat)+
ylab("height (cm)")+
xlab("mdaysfromgerm")+
ggtitle("DACGLO height vs. days since germ  by color=continent, column=strat(days), row=temp(C)")
pdf("plot4_mean.pdf", width=8.5, height=11)
print(plot4b)
dev.off()
pdf(file="heightbyspecies.pdf")
for(i in 1:length(species)){
a<-ggplot(subset(gh, sp==species[i]), aes(x=(mdaysfromgerm),y=plantheight, color=origin, group=trayloc))+
geom_line(size=.6, alpha=.2) +geom_point(position=pd, size=1.6, alpha=.2)+
geom_smooth(aes(group = origin), size = 1, method = "lm", se = FALSE, alpha=1)+
facet_grid(temp~strat)+
ylab("height (cm)")+
xlab("days since germination")+
ggtitle(paste(species[i], " height vs. age by  column=strat(days), row=temp(C)"))
print(a)
#ggsave("heightbyspecies.pdf")
}
dev.off()
plot3c<-ggplot(germinatedsummarygrts, aes(x=(as.factor(temp)),y=mean, color=origin, group=origin))+
geom_errorbar(aes(ymin=mean-sem, ymax=mean+sem), width=.2, position=pd, size=.8) +
geom_line(size=.6) +geom_point(position=pd, size=1.6)+
facet_grid(sp~strat)+
ylab("growth rate")+
xlab("mean temp (C)")+
ggtitle("growth rate vs. temp by continent and strat for each sp")
plot2c <-ggplot(germinatedsummarygr, aes(x=sp,y=mean, color=origin))+
geom_errorbar(aes(ymin=mean-sem, ymax=mean+sem), width=.4, position=pd, size=.8) +
geom_point(position=pd, size=3.6)+
ylab("growth rate")+
xlab("species")+
ggtitle("growth rate vs. species by continent")
plot1c <-ggplot(germinatedsummarygrloc, aes(x=sp,y=mean, color=location, shape=origin))+
geom_errorbar(aes(ymin=mean-sem, ymax=mean+sem), width=.4, position=pd, size=.8) +
geom_point(position=pd, size=3.6)+
ylab("growth rate")+
xlab("species")+
ggtitle("growth rate vs. species by population")
pdf("plot1.pdf", width=11, height=8.5)
print(plot1a)
print(plot1b)
print(plot1c)
pdf("plot2.pdf", width=11, height=8.5)
dev.off()
dev.off()
pdf("plot2.pdf", width=11, height=8.5)
print(plot2a)
print(plot2b)
print(plot2c)
dev.off()
pdf("plot3.pdf", height=11, width=8.5)
print(plot3a)
print(plot3b)
print(plot3c)
dev.off()
