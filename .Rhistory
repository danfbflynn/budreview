#test push
# Budburst Lit review analysis.
# started for 'data_simple', now working with data_detailed from the main xlsx sheet
# Tim Todo: understand how to use head, summary, plot functions in R with data_simple, and also look at data_detailed. How many species do we have, how many papers are entered?
library(gdata) # for read.xls
library(scales) # for alpha
#d <- read.xls("~/Dropbox/Work/Harvard/budburst review/Archive/growthchambers_litreview_2015-09-25.xlsx", sheet = 6)
setwd("~/Documents/git/budreview")
d <- read.csv("data_simple.csv")
de <- read.csv("data_detailed.csv")
# Todo: make a numeric version, deal with 'natural' and 'ambient'
d$temp_day <- sub("natural", "", d$temp_day)
d$temp_day <- sub("ambient", "", d$temp_day)
d$temp_day <- as.numeric(as.character(d$temp_day))
d$temp_night <- sub("natural", "", d$temp_night)
d$temp_night <- sub("ambient", "", d$temp_night)
d$temp_night <- as.numeric(as.character(d$temp_night))
d$photoperiod_day <- sub("natural", "", d$photoperiod_day)
d$photoperiod_day <- sub("ambient", "", d$photoperiod_day)
d$photoperiod_day <- as.numeric(as.character(d$photoperiod_day))
d$photoperiod_night <- sub("natural", "", d$photoperiod_night)
d$photoperiod_night <- sub("ambient", "", d$photoperiod_night)
d$photoperiod_night <- as.numeric(as.character(d$photoperiod_night))
tapply(d$temp_day, d$datasetID, mean, na.rm=T)
tapply(d$temp_night, d$datasetID, mean)
d.cutt <- d[d$material == "cuttings",]
d.cutt <- d.cutt[order(d.cutt$temp_day),]
d.seed <- d[d$material != "cuttings",]
d.seed <- d.seed[order(d.seed$temp_day),]
cols = alpha(c("red", "blue"), 0.5)
pdf("graphs/Lit review check.pdf", height = 8, width = 6)
par(mfrow = c(2, 1))
plot(d.cutt$temp_day, pch = "-", col = cols[1], cex = 2,
ylim = c(-5, 35),
xlab = "Study",
ylab = "Temp")
points(d.cutt$temp_night, pch = "-", col = cols[2], cex = 2)
abline(h = mean(d.cutt[d.cutt$temp_day != d.cutt$temp_night,"temp_day"]), col = cols[1], lty = 2)
abline(h = mean(d.cutt[d.cutt$temp_day != d.cutt$temp_night,"temp_night"]), col = cols[2], lty = 2)
title(main = "Day/night temps by study")
legend("topleft", bty = "n", "Cuttings")
plot(d.seed$temp_day, pch = "-", col = cols[1], cex = 2,
ylim = c(-5, 35),
xlab = "Study",
ylab = "Temp")
points(d.seed$temp_night, pch = "-", col = cols[2], cex = 2)
abline(h = mean(d.seed[d.seed$temp_day != d.seed$temp_night,"temp_day"]), col = cols[1], lty = 2)
abline(h = mean(d.seed[d.seed$temp_day != d.seed$temp_night,"temp_night"]), col = cols[2], lty = 2)
legend("topleft", bty = "n", "Seedlings or other material")
## summary statistics
# Cuttings with day/night diff
summary(d.cutt[d.cutt$temp_day != d.cutt$temp_night,])
# day: 15, night 7
summary(d.cutt[d.cutt$temp_day == d.cutt$temp_night,])
# day & night 16.5
# Daylength
d.cutt <- d.cutt[order(d.cutt$photoperiod_day),]
d.seed <- d.seed[order(d.seed$photoperiod_day),]
cols = alpha(c("red", "blue"), 0.5)
par(mfrow = c(2, 1))
plot(d.cutt$photoperiod_day, pch = "-", col = cols[1], cex = 2,
ylim = c(0, 24),
xlab = "Study",
ylab = "Daylength")
#points(d.cutt$photoperiod_night, pch = "-", col = cols[2], cex = 2)
abline(h = mean(d.cutt[,"photoperiod_day"],na.rm=T), col = cols[1], lty = 2)
title(main = "Daylength by study")
legend("topleft", bty = "n", "Cuttings")
plot(d.seed$photoperiod_day, pch = "-", col = cols[1], cex = 2,
ylim = c(0, 24),
xlab = "Study",
ylab = "Daylength")
#points(d.seed$photoperiod_night, pch = "-", col = cols[2], cex = 2)
abline(h = mean(d.seed[,"photoperiod_day"],na.rm=T), col = cols[1], lty = 2)
legend("topleft", bty = "n", "Seedlings or other material")
dev.off(); system("open 'graphs/Lit review check.pdf' -a /Applications/Preview.app")
# Short days: 10 hr, 8:00 to 16:00
# long days: 12 hr, 7:00 to 19:00
# constant over experiemnt
# SH: 5 degrees cooler in winter, 2 degrees cooler in summer
# temp end may:
# Warm: 10 - 20
# temp mid may
# Cool: 7 - 17
# early may: 5 - 15
# DAN todo: start looking at data_detailed, and analyzing the responses
# response ~ photo + temp + (1|species) + (1|study)
summary(de)
data.frame(table(de$respvar))
# one approach: scale each response within study, look at general response
scaledresp <- vector()
for(i in unique(de$respvar)){
dx <- de[de$respvar == i,]
scaledresp <- c(scaledresp, scale(dx$response))
}
de$scaledresp = scaledresp
scaledresp
de$forcetemp
photoperiod_day
de$photoperiod_day
de$photoperiod_day <- sub("continuous", 24, de$photoperiod_day)
de$photoperiod_day <- sub("shortday", 10, de$photoperiod_day)
de$photoperiod_day <- sub("longday", 14, de$photoperiod_day)
d$photoperiod_day <- as.numeric(as.character(d$photoperiod_day))
de$photoperiod_day <- as.numeric(as.character(de$photoperiod_day))
de$photoperiod_day
summary(de$photoperiod_day)
de$forcetem
de$forcetem <- sub("ambient", "", de$forcetem)
de$forcetem <- sub("24, 13", 24, de$forcetem)
de$forcetem <- sub("meandaily", "", de$forcetem)
de$forcetem <- as.numeric(as.character(de$forcetem))
de$forcetem
de$forcetemp
de$forcetemp <- sub("ambient", "", de$forcetemp)
de$forcetemp <- sub("24, 13", 24, de$forcetemp)
de$forcetemp <- sub("meandaily", "", de$forcetemp)
de$forcetemp <- as.numeric(as.character(de$forcetemp))
de$forcetemp
de$chilltemp
m1 <- lm(scaledresp ~ forcetemp * photoperiod_day, data = de)
summary(m1)
summary.aov(m1)
kable(summary.aov(m1))
library(knitr)
kable(summary.aov(m1))
summary.aov(m1)
m1 <- lmer(scaledresp ~ forcetemp * photoperiod_day + (1|sp), data = de)
library(lme4)
m1 <- lmer(scaledresp ~ forcetemp * photoperiod_day + (1|sp), data = de)
names(de)
m1 <- lmer(scaledresp ~ forcetemp * photoperiod_day + (1|species) + (1|study), data = de)
summary(m2)
m2 <- lmer(scaledresp ~ forcetemp * photoperiod_day + (1|species) + (1|study), data = de)
summary(m2)
summary.aov(m1)
m1 <- lm(scaledresp ~ forcetemp * photoperiod_day, data = de)
summary.aov(m1)
library(lme4)
summary.aov(m1)
summary(m1)
