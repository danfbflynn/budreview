geo.photo<-ggplot(fxx, aes(x=Lat, y=photoperiod, col=photo.type, shape=photo.type, alpha=photo.type)) + geom_point(aes(col=photo.type)) + geom_jitter(aes(col=photo.type)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
text=element_text(family="sans")) + xlab("Latitude") + ylab("Daylength (hours)") +
scale_y_continuous(ylim=c(0, 25), expand=c(0,0)) + guides(col=FALSE) + ggtitle("A") +
scale_colour_manual(name="Data Type", values=c(cols,"black"),
labels=c(current = "Current",
aprojected = "Projected",
ospree = "OSPREE")) + guides(shape=FALSE, alpha=FALSE)+
scale_shape_manual(name="Data Type", values=c(16, 15, 17),
labels=c(current = "Current",
aprojected = "Projected",
ospree = "OSPREE")) +
scale_alpha_manual(name="Data Type", values=c(0.1,0.1,1),
labels=c(zcurrent = "Current",
projected = "Projected",
ospree = "OSPREE"))
geo.photo<-ggplot(fxx, aes(x=Lat, y=photoperiod, col=photo.type, shape=photo.type, alpha=photo.type)) + geom_point(aes(col=photo.type)) + geom_jitter(aes(col=photo.type)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
text=element_text(family="sans")) + xlab("Latitude") + ylab("Daylength (hours)") +
scale_y_continuous(limits=c(0, 25), expand=c(0,0)) + guides(col=FALSE) + ggtitle("A") +
scale_colour_manual(name="Data Type", values=c(cols,"black"),
labels=c(current = "Current",
aprojected = "Projected",
ospree = "OSPREE")) + guides(shape=FALSE, alpha=FALSE)+
scale_shape_manual(name="Data Type", values=c(16, 15, 17),
labels=c(current = "Current",
aprojected = "Projected",
ospree = "OSPREE")) +
scale_alpha_manual(name="Data Type", values=c(0.1,0.1,1),
labels=c(zcurrent = "Current",
projected = "Projected",
ospree = "OSPREE"))
geo.photo
geo.photo<-ggplot(fxx, aes(x=Lat, y=photoperiod, col=photo.type, shape=photo.type, alpha=photo.type)) + geom_point(aes(col=photo.type)) + geom_jitter(aes(col=photo.type)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
text=element_text(family="sans")) + xlab("Latitude") + ylab("Daylength (hours)") +
scale_y_continuous(limits=c(0, 24), expand=c(0,0)) + guides(col=FALSE) + ggtitle("A") +
scale_colour_manual(name="Data Type", values=c(cols,"black"),
labels=c(current = "Current",
aprojected = "Projected",
ospree = "OSPREE")) + guides(shape=FALSE, alpha=FALSE)+
scale_shape_manual(name="Data Type", values=c(16, 15, 17),
labels=c(current = "Current",
aprojected = "Projected",
ospree = "OSPREE")) +
scale_alpha_manual(name="Data Type", values=c(0.1,0.1,1),
labels=c(zcurrent = "Current",
projected = "Projected",
ospree = "OSPREE"))
phen<- ggplot(ff, aes(x=phen.shift, y=photo.shift)) + geom_point(aes(col=type)) + geom_jitter() +
#geom_polygon( data=hulls.phen, alpha=.5, aes(fill=type)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
axis.ticks.y = element_blank(), legend.position = "none")
#find_hull.phen <- function(fxx) fxx[chull(fxx$doy, fxx$photoperiod), ]
#hulls.phen <- ddply(fxx, "type", find_hull.phen)
doy.photo<- ggplot(fxx, aes(x=doy, y=photoperiod, col=phen.type, shape=phen.type, alpha=phen.type)) + geom_point(aes(col=phen.type)) + geom_jitter(aes(col=phen.type)) +
#geom_polygon( data=hulls.phen, alpha=.5, aes(fill=phen.type)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
legend.position = c(0.82,0.85), legend.text = element_text(size=9), legend.title = element_text(size=10),
legend.key = element_rect(colour = NA, fill = NA), legend.box.background = element_rect(), text=element_text(family="sans")) + xlab("Day of Budburst") + ylab("Daylength (hours)") +
labs(col="Data Type") + ggtitle("B") +
scale_colour_manual(name="Data Type", values=c(cols, "black"),
labels=c(current = "Current",
aprojected = "Projected",
ospree = "OSPREE")) + guides(size=FALSE, alpha=FALSE) +
scale_shape_manual(name="Data Type", values=c(16, 15, 17),
labels=c(current = "Current",
aprojected = "Projected",
ospree = "OSPREE")) +
scale_alpha_manual(name="Data Type", values=c(0.1,0.1,1),
labels=c(current = "Current",
aprojected = "Projected",
ospree = "OSPREE")) +
scale_y_continuous(limits=c(0, 24), expand=c(0,0))
ggarrange(geo.photo, doy.photo, ncol=2)
doy.photo<- ggplot(fxx, aes(x=doy, y=photoperiod, col=phen.type, shape=phen.type, alpha=phen.type)) + geom_point(aes(col=phen.type)) + geom_jitter(aes(col=phen.type)) +
#geom_polygon( data=hulls.phen, alpha=.5, aes(fill=phen.type)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
legend.position = c(0.82,0.85), legend.text = element_text(size=9), legend.title = element_text(size=10),
legend.key = element_rect(colour = NA, fill = NA), legend.box.background = element_rect(), text=element_text(family="sans")) + xlab("Day of Budburst") + ylab("Daylength (hours)") +
labs(col="Data Type") + ggtitle("B") +
scale_colour_manual(name="Data Type", values=c(cols, "black"),
labels=c(current = "Current",
aprojected = "Projected",
ospree = "OSPREE")) + guides(size=FALSE, alpha=FALSE) +
scale_shape_manual(name="Data Type", values=c(16, 15, 17),
labels=c(current = "Current",
aprojected = "Projected",
ospree = "OSPREE")) +
scale_alpha_manual(name="Data Type", values=c(0.1,0.1,1),
labels=c(current = "Current",
aprojected = "Projected",
ospree = "OSPREE")) +
scale_y_continuous(limits=c(0, 25), breaks=c(0,4,8,12,16,20,24) expand=c(0,0))
doy.photo<- ggplot(fxx, aes(x=doy, y=photoperiod, col=phen.type, shape=phen.type, alpha=phen.type)) + geom_point(aes(col=phen.type)) + geom_jitter(aes(col=phen.type)) +
#geom_polygon( data=hulls.phen, alpha=.5, aes(fill=phen.type)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
legend.position = c(0.82,0.85), legend.text = element_text(size=9), legend.title = element_text(size=10),
legend.key = element_rect(colour = NA, fill = NA), legend.box.background = element_rect(), text=element_text(family="sans")) + xlab("Day of Budburst") + ylab("Daylength (hours)") +
labs(col="Data Type") + ggtitle("B") +
scale_colour_manual(name="Data Type", values=c(cols, "black"),
labels=c(current = "Current",
aprojected = "Projected",
ospree = "OSPREE")) + guides(size=FALSE, alpha=FALSE) +
scale_shape_manual(name="Data Type", values=c(16, 15, 17),
labels=c(current = "Current",
aprojected = "Projected",
ospree = "OSPREE")) +
scale_alpha_manual(name="Data Type", values=c(0.1,0.1,1),
labels=c(current = "Current",
aprojected = "Projected",
ospree = "OSPREE")) +
scale_y_continuous(limits=c(0, 25), breaks=c(0,4,8,12,16,20,24), expand=c(0,0))
doy.photo
geo.photo<-ggplot(fxx, aes(x=Lat, y=photoperiod, col=photo.type, shape=photo.type, alpha=photo.type)) + geom_point(aes(col=photo.type)) + geom_jitter(aes(col=photo.type)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
text=element_text(family="sans")) + xlab("Latitude") + ylab("Daylength (hours)") +
guides(col=FALSE) + ggtitle("A") +
scale_colour_manual(name="Data Type", values=c(cols,"black"),
labels=c(current = "Current",
aprojected = "Projected",
ospree = "OSPREE")) + guides(shape=FALSE, alpha=FALSE)+
scale_shape_manual(name="Data Type", values=c(16, 15, 17),
labels=c(current = "Current",
aprojected = "Projected",
ospree = "OSPREE")) +
scale_alpha_manual(name="Data Type", values=c(0.1,0.1,1),
labels=c(zcurrent = "Current",
projected = "Projected",
ospree = "OSPREE")) +
scale_y_continuous(limits=c(0, 25), breaks=c(0,4,8,12,16,20,24), expand=c(0,0))
doy.photo<- ggplot(fxx, aes(x=doy, y=photoperiod, col=phen.type, shape=phen.type, alpha=phen.type)) + geom_point(aes(col=phen.type)) + geom_jitter(aes(col=phen.type)) +
#geom_polygon( data=hulls.phen, alpha=.5, aes(fill=phen.type)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
legend.position = c(0.82,0.85), legend.text = element_text(size=9), legend.title = element_text(size=10),
legend.key = element_rect(colour = NA, fill = NA), legend.box.background = element_rect(), text=element_text(family="sans")) + xlab("Day of Budburst") + ylab("Daylength (hours)") +
labs(col="Data Type") + ggtitle("B") +
scale_colour_manual(name="Data Type", values=c(cols, "black"),
labels=c(current = "Current",
aprojected = "Projected",
ospree = "OSPREE")) + guides(size=FALSE, alpha=FALSE) +
scale_shape_manual(name="Data Type", values=c(16, 15, 17),
labels=c(current = "Current",
aprojected = "Projected",
ospree = "OSPREE")) +
scale_alpha_manual(name="Data Type", values=c(0.1,0.1,1),
labels=c(current = "Current",
aprojected = "Projected",
ospree = "OSPREE")) +
scale_y_continuous(limits=c(0, 25), breaks=c(0,4,8,12,16,20,24), expand=c(0,0))
ggarrange(geo.photo, doy.photo, ncol=2)
qr.present<-read.csv("output/phenofit_projections/Quercus_robur_1981_2000_daylength.csv", header=TRUE)
qr.pres<-read.csv("output/phenofit_projections/Quercus_robur_1981_2000.csv", header=TRUE)
qr.proj<-read.csv("output/phenofit_projections/Quercus_robur_A1Fi_2081_2100_daylength.csv", header=TRUE)
qr.proj.pres<-read.csv("output/phenofit_projections/Quercus_robur_A1Fi_2081_2100.csv", header=TRUE)
qr.present<-qr.present%>%dplyr::rename(mleaf=MeanDateLeaf)
qr.proj<-qr.proj%>%dplyr::rename(proj.lodoy=lodoy)%>%dplyr::rename(proj.photo=daylength)
qr<-full_join(qr.present, qr.proj)
qr.pres<-subset(qr.pres, pres==1)
qr.pres$avg<-ave(qr.pres$Lat)
qr.proj.pres<-subset(qr.proj.pres, pres==1)
qr.proj.pres$avg<-ave(qr.proj.pres$Lat)
shift<-unique(qr.proj.pres$avg) - unique(qr.pres$avg)
qr.pres$geo.shift<-qr.pres$Lat + shift
qr.geo<-full_join(qr, qr.pres)
qr.geo$date<-as.Date(qr.geo$lodoy, origin = "2000-01-01")
qr.geo$photo.shift<-qr.geo$daylength-qr.geo$proj.photo
#qr.geo$photo.shift<-NA
#for(i in c(1:nrow(qr.geo))){
#  qr.geo$photo.shift[i] <- daylength(qr.geo$geo.shift[i], qr.geo$date[i])
#}
qr.geo<-qr.geo[!is.na(qr.geo$photo.shift),]
qr.geo<-qr.geo[!is.na(qr.geo$geo.shift),]
qr.geo$phen.shift<-qr.geo$lodoy-qr.geo$proj.lodoy ## first pheno.shift
qr.geo$type<-"projected"
### Now for Ospree! ####
qrob<-osp[which(osp$genus=="Quercus" & osp$species == "robur" & osp$respvar.simple=="daystobudburst"),]
qrob<-qrob%>%dplyr::select(datasetID, genus, species, photoperiod_day, response.time, provenance.lat, fieldsample.date2)
qrob<-qrob[(qrob$response.time!=999),]
qrob$photoperiod_day<-as.numeric(qrob$photoperiod_day)
qrob$photo.min<-ave(qrob$photoperiod_day, qrob$datasetID, FUN=min)
qrob$photo.max<-ave(qrob$photoperiod_day, qrob$datasetID, FUN=max)
qrob$photo.shift<-qrob$photo.max-qrob$photo.min
qrob$response.time<-as.numeric(qrob$response.time)
bb.min<-qrob[which(qrob$photoperiod_day==qrob$photo.min),]
bb.min$bb.min<-ave(bb.min$response.time, bb.min$datasetID)
bb.max<-qrob[which(qrob$photoperiod_day==qrob$photo.max),]
bb.max$bb.max<-ave(bb.max$response.time, bb.max$datasetID)
qrob$phen.shift<-NA
for(i in c(1:nrow(qrob))){
for(j in c(1:nrow(bb.min)))
for(k in c(1:nrow(bb.max)))
qrob$phen.shift[i]<-ifelse(qrob$datasetID[i]==bb.min$datasetID[j] & qrob$datasetID[i]==bb.max$datasetID[k],
bb.min$bb.min[j]-bb.max$bb.max[k], qrob$phen.shift[i])
}
qrob$provenance.lat<-as.numeric(qrob$provenance.lat)
#### Using code from Ailene's shifts_table.R ###
qrob$phendate<-ave(qrob$response.time, qrob$datasetID)
qrob$space<-NA
for(i in 1:length(qrob$provenance.lat)){
latshift<-seq(0,40,by=.1)#look at daylengths of latitudes from study site to study site plus 40 degrees
photos_spat<-daylength(qrob$provenance.lat[i]+latshift, qrob$phendate[i])
#photop$space[i]<-
maxdelta_space<-max(photos_spat, na.rm=TRUE)-min(photos_spat, na.rm=TRUE)#maxim
delta_space<-photos_spat[1]-photos_spat#change in daylength latitudes ranging from study site to study site plus 40 degrees
if(maxdelta_space<abs(qrob$photo.shift[i])){qrob$space[i]<-100}#exceeds range
else
qrob$space[i]<-latshift[min(which(round(delta_space, digits=2)==qrob$photo.shift[i]))]#select min lat shift required to get change in daylength in experiments
if(is.na(qrob$space[i])){
mindiff<-min(abs(qrob$photo.shift[i]-delta_space), na.rm=TRUE)
if(!is.na(mindiff) & mindiff<0.5){qrob$space[i]<-latshift[which(abs(qrob$photo.shift[i]-delta_space)==mindiff)]
}else {
qrob$space[i]<-NA
}
}
}
qrob$space<-as.numeric(qrob$space)
qrob$geo.shift<-qrob$space+qrob$provenance.lat
qrob<-qrob%>%dplyr::rename(photoperiod=photoperiod_day)%>%dplyr::rename(doy=response.time)%>%dplyr::rename(Lat=provenance.lat)
qrob$photo.type<-"ospree"
qrob$phen.type<-"ospree"
qrob<-qrob%>%dplyr::select(Lat, photoperiod, photo.type, phen.type, doy)
qr<-dplyr::select(qr.geo, Lat, mleaf, lodoy, daylength, type, photo.shift, geo.shift, phen.shift, proj.lodoy, proj.photo, daylength)
qx<-qr%>%gather("phen.type", "doy", -Lat, -mleaf, -type, -photo.shift, -geo.shift,
-phen.shift, -proj.photo, -daylength)
qxx<-qx%>%gather("photo.type", "photoperiod", -Lat, -mleaf, -doy, -phen.type, -type, -photo.shift, -geo.shift, -phen.shift,
-doy)
qxx<-dplyr::select(qxx, Lat, photoperiod, photo.type, doy, phen.type)
qxx<-full_join(qxx, qrob)
#find_hull.geo <- function(fxx) fxx[chull(fxx$Lat, fxx$photoperiod), ]
#library(plyr)
#hulls.geo <- ddply(fxx, "type", find_hull.geo)
qxx$photo.type<-ifelse(qxx$photo.type=="daylength", "current", qxx$photo.type)
qxx$photo.type<-ifelse(qxx$photo.type=="proj.photo", "aprojected", qxx$photo.type)
qxx$phen.type<-ifelse(qxx$phen.type=="lodoy", "current", qxx$phen.type)
qxx$phen.type<-ifelse(qxx$phen.type=="proj.lodoy", "aprojected", qxx$phen.type)
unique(ave(qxx$doy[which(qxx$phen.type=="current")], FUN=min)) ## 88
qxx$doy<-ifelse(qxx$phen.type=="ospree", qxx$doy+88, qxx$doy)
geo.photo<-ggplot(qxx, aes(x=Lat, y=photoperiod, col=photo.type, shape=photo.type, alpha=photo.type)) + geom_point(aes(col=photo.type)) + geom_jitter(aes(col=photo.type)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
axis.ticks.y = element_blank(), text=element_text(family="sans")) + xlab("Latitude") + ylab("Daylength (hours)") +
guides(col=FALSE) + ggtitle("A") +
scale_colour_manual(values=c(cols, "black"),
labels=c(current = "Current",
aprojected = "Projected",
ospree = "OSPREE")) + guides(shape=FALSE, alpha=FALSE)+
scale_shape_manual(name="Data Type", values=c(16, 15, 17),
labels=c(current = "Current",
aprojected = "Projected",
ospree = "OSPREE")) +
scale_alpha_manual(name="Data Type", values=c(0.1,0.1,1),
labels=c(current = "Current",
aprojected = "Projected",
ospree = "OSPREE")) +
scale_y_continuous(limits=c(0, 25), breaks=c(0,4,8,12,16,20,24), expand=c(0,0))
doy.photo<- ggplot(qxx, aes(x=doy, y=photoperiod, col=phen.type, shape=phen.type, alpha=phen.type)) + geom_point(aes(col=phen.type)) + geom_jitter(aes(col=phen.type)) +
#geom_polygon( data=hulls.phen, alpha=.5, aes(fill=phen.type)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
axis.ticks.y = element_blank(), legend.position = c(0.82,0.85), legend.text = element_text(size=9), legend.title = element_text(size=10),
legend.key = element_rect(colour = NA, fill = NA), legend.box.background = element_rect(), text=element_text(family="sans")) + xlab("Day of Budburst") + ylab("Daylength (hours)") +
labs(col="Data Type") + ggtitle("B") +
scale_colour_manual(name="Data Type", values=c(cols, "black"),
labels=c(current = "Current",
dprojected = "Projected",
ospree = "OSPREE")) + guides(shape=FALSE, alpha=FALSE) +
scale_shape_manual(name="Data Type", values=c(16, 15, 17),
labels=c(current = "Current",
dprojected = "Projected",
ospree = "OSPREE")) +
scale_alpha_manual(name="Data Type", values=c(0.7,0.7,1.7),
labels=c(current = "Current",
dprojected = "Projected",
ospree = "OSPREE")) +
scale_y_continuous(limits=c(0, 25), breaks=c(0,4,8,12,16,20,24), expand=c(0,0))
quartz()
ggarrange(geo.photo, doy.photo, ncol=2)
doy.photo<- ggplot(qxx, aes(x=doy, y=photoperiod, col=phen.type, shape=phen.type, alpha=phen.type)) + geom_point(aes(col=phen.type)) + geom_jitter(aes(col=phen.type)) +
#geom_polygon( data=hulls.phen, alpha=.5, aes(fill=phen.type)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
axis.ticks.y = element_blank(), legend.position = c(0.82,0.85), legend.text = element_text(size=9), legend.title = element_text(size=10),
legend.key = element_rect(colour = NA, fill = NA), legend.box.background = element_rect(), text=element_text(family="sans")) + xlab("Day of Budburst") + ylab("Daylength (hours)") +
labs(col="Data Type") + ggtitle("B") +
scale_colour_manual(name="Data Type", values=c(cols, "black"),
labels=c(current = "Current",
dprojected = "Projected",
ospree = "OSPREE")) + guides(shape=FALSE, alpha=FALSE) +
scale_shape_manual(name="Data Type", values=c(16, 15, 17),
labels=c(current = "Current",
dprojected = "Projected",
ospree = "OSPREE")) +
scale_alpha_manual(name="Data Type", values=c(0.1,0.1,1),
labels=c(current = "Current",
dprojected = "Projected",
ospree = "OSPREE")) +
scale_y_continuous(limits=c(0, 25), breaks=c(0,4,8,12,16,20,24), expand=c(0,0))
ggarrange(geo.photo, doy.photo, ncol=2)
doy.photo<- ggplot(qxx, aes(x=doy, y=photoperiod, col=phen.type, shape=phen.type, alpha=phen.type)) + geom_point(aes(col=phen.type)) + geom_jitter(aes(col=phen.type)) +
#geom_polygon( data=hulls.phen, alpha=.5, aes(fill=phen.type)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
axis.ticks.y = element_blank(), legend.position = c(0.82,0.85), legend.text = element_text(size=9), legend.title = element_text(size=10),
legend.key = element_rect(colour = NA, fill = NA), legend.box.background = element_rect(), text=element_text(family="sans")) + xlab("Day of Budburst") + ylab("Daylength (hours)") +
labs(col="Data Type") + ggtitle("B") +
scale_colour_manual(name="Data Type", values=c(cols, "black"),
labels=c(current = "Current",
aprojected = "Projected",
ospree = "OSPREE")) + guides(shape=FALSE, alpha=FALSE) +
scale_shape_manual(name="Data Type", values=c(16, 15, 17),
labels=c(current = "Current",
aprojected = "Projected",
ospree = "OSPREE")) +
scale_alpha_manual(name="Data Type", values=c(0.1,0.1,1),
labels=c(current = "Current",
aprojected = "Projected",
ospree = "OSPREE")) +
scale_y_continuous(limits=c(0, 25), breaks=c(0,4,8,12,16,20,24), expand=c(0,0))
ggarrange(geo.photo, doy.photo, ncol=2)
range(qxx$doy)
doy.photo<- ggplot(qxx, aes(x=doy, y=photoperiod, col=phen.type, shape=phen.type, alpha=phen.type)) + geom_point(aes(col=phen.type)) + geom_jitter(aes(col=phen.type)) +
#geom_polygon( data=hulls.phen, alpha=.5, aes(fill=phen.type)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
axis.ticks.y = element_blank(), legend.position = "none", legend.text = element_text(size=9), legend.title = element_text(size=10),
legend.key = element_rect(colour = NA, fill = NA), legend.box.background = element_rect(), text=element_text(family="sans")) + xlab("Day of Budburst") + ylab("Daylength (hours)") +
labs(col="Data Type") + ggtitle("B") +
scale_colour_manual(name="Data Type", values=c(cols, "black"),
labels=c(current = "Current",
aprojected = "Projected",
ospree = "OSPREE")) + guides(shape=FALSE, alpha=FALSE) +
scale_shape_manual(name="Data Type", values=c(16, 15, 17),
labels=c(current = "Current",
aprojected = "Projected",
ospree = "OSPREE")) +
scale_alpha_manual(name="Data Type", values=c(0.1,0.1,1),
labels=c(current = "Current",
aprojected = "Projected",
ospree = "OSPREE")) +
scale_y_continuous(limits=c(0, 25), breaks=c(0,4,8,12,16,20,24), expand=c(0,0))
ggarrange(geo.photo, doy.photo, ncol=2)
doy.photo<- ggplot(qxx, aes(x=doy, y=photoperiod, col=phen.type, shape=phen.type, alpha=phen.type)) + geom_point(aes(col=phen.type)) + geom_jitter(aes(col=phen.type)) +
#geom_polygon( data=hulls.phen, alpha=.5, aes(fill=phen.type)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
legend.position = "none", legend.text = element_text(size=9), legend.title = element_text(size=10),
legend.key = element_rect(colour = NA, fill = NA), legend.box.background = element_rect(), text=element_text(family="sans")) + xlab("Day of Budburst") + ylab("Daylength (hours)") +
labs(col="Data Type") + ggtitle("B") +
scale_colour_manual(name="Data Type", values=c(cols, "black"),
labels=c(current = "Current",
aprojected = "Projected",
ospree = "OSPREE")) + guides(shape=FALSE, alpha=FALSE) +
scale_shape_manual(name="Data Type", values=c(16, 15, 17),
labels=c(current = "Current",
aprojected = "Projected",
ospree = "OSPREE")) +
scale_alpha_manual(name="Data Type", values=c(0.1,0.1,1),
labels=c(current = "Current",
aprojected = "Projected",
ospree = "OSPREE")) +
scale_y_continuous(limits=c(0, 25), breaks=c(0,4,8,12,16,20,24), expand=c(0,0)) +scale_x_continuous(limits=c(0,220))
ggarrange(geo.photo, doy.photo, ncol=2)
View(qxx)
qxx<-na.omit(qxx)
geo.photo<-ggplot(qxx, aes(x=Lat, y=photoperiod, col=photo.type, shape=photo.type, alpha=photo.type)) + geom_point(aes(col=photo.type)) + geom_jitter(aes(col=photo.type)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
text=element_text(family="sans")) + xlab("Latitude") + ylab("Daylength (hours)") +
guides(col=FALSE) + ggtitle("A") +
scale_colour_manual(values=c(cols, "black"),
labels=c(current = "Current",
aprojected = "Projected",
ospree = "OSPREE")) + guides(shape=FALSE, alpha=FALSE)+
scale_shape_manual(name="Data Type", values=c(16, 15, 17),
labels=c(current = "Current",
aprojected = "Projected",
ospree = "OSPREE")) +
scale_alpha_manual(name="Data Type", values=c(0.1,0.1,1),
labels=c(current = "Current",
aprojected = "Projected",
ospree = "OSPREE")) +
scale_y_continuous(limits=c(0, 25), breaks=c(0,4,8,12,16,20,24), expand=c(0,0))
doy.photo<- ggplot(qxx, aes(x=doy, y=photoperiod, col=phen.type, shape=phen.type, alpha=phen.type)) + geom_point(aes(col=phen.type)) + geom_jitter(aes(col=phen.type)) +
#geom_polygon( data=hulls.phen, alpha=.5, aes(fill=phen.type)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
legend.position = "none", legend.text = element_text(size=9), legend.title = element_text(size=10),
legend.key = element_rect(colour = NA, fill = NA), legend.box.background = element_rect(), text=element_text(family="sans")) + xlab("Day of Budburst") + ylab("Daylength (hours)") +
labs(col="Data Type") + ggtitle("B") +
scale_colour_manual(name="Data Type", values=c(cols, "black"),
labels=c(current = "Current",
aprojected = "Projected",
ospree = "OSPREE")) + guides(shape=FALSE, alpha=FALSE) +
scale_shape_manual(name="Data Type", values=c(16, 15, 17),
labels=c(current = "Current",
aprojected = "Projected",
ospree = "OSPREE")) +
scale_alpha_manual(name="Data Type", values=c(0.1,0.1,1),
labels=c(current = "Current",
aprojected = "Projected",
ospree = "OSPREE")) +
scale_y_continuous(limits=c(0, 25), breaks=c(0,4,8,12,16,20,24), expand=c(0,0))
ggarrange(geo.photo, doy.photo, ncol=2)
geo.photo<-ggplot(qxx, aes(x=Lat, y=photoperiod, col=photo.type, shape=photo.type, alpha=photo.type)) + geom_point(aes(col=photo.type)) + geom_jitter(aes(col=photo.type)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
text=element_text(family="sans")) + xlab("Latitude") + ylab("Daylength (hours)") +
guides(col=FALSE) + ggtitle("A") +
scale_colour_manual(values=c(cols, "black"),
labels=c(current = "Current",
aprojected = "Projected",
ospree = "OSPREE")) + guides(shape=FALSE, alpha=FALSE)+
scale_shape_manual(name="Data Type", values=c(16, 15, 17),
labels=c(current = "Current",
aprojected = "Projected",
ospree = "OSPREE")) +
scale_alpha_manual(name="Data Type", values=c(0.4,0.4,1),
labels=c(current = "Current",
aprojected = "Projected",
ospree = "OSPREE")) +
scale_y_continuous(limits=c(0, 25), breaks=c(0,4,8,12,16,20,24), expand=c(0,0))
doy.photo<- ggplot(qxx, aes(x=doy, y=photoperiod, col=phen.type, shape=phen.type, alpha=phen.type)) + geom_point(aes(col=phen.type)) + geom_jitter(aes(col=phen.type)) +
#geom_polygon( data=hulls.phen, alpha=.5, aes(fill=phen.type)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
legend.position = "none", legend.text = element_text(size=9), legend.title = element_text(size=10),
legend.key = element_rect(colour = NA, fill = NA), legend.box.background = element_rect(), text=element_text(family="sans")) + xlab("Day of Budburst") + ylab("Daylength (hours)") +
labs(col="Data Type") + ggtitle("B") +
scale_colour_manual(name="Data Type", values=c(cols, "black"),
labels=c(current = "Current",
aprojected = "Projected",
ospree = "OSPREE")) + guides(shape=FALSE, alpha=FALSE) +
scale_shape_manual(name="Data Type", values=c(16, 15, 17),
labels=c(current = "Current",
aprojected = "Projected",
ospree = "OSPREE")) +
scale_alpha_manual(name="Data Type", values=c(0.4,0.4,1),
labels=c(current = "Current",
aprojected = "Projected",
ospree = "OSPREE")) +
scale_y_continuous(limits=c(0, 25), breaks=c(0,4,8,12,16,20,24), expand=c(0,0))
ggarrange(geo.photo, doy.photo, ncol=2)
geo.photo<-ggplot(qxx, aes(x=Lat, y=photoperiod, col=photo.type, shape=photo.type, alpha=photo.type)) + geom_point(aes(col=photo.type)) + geom_jitter(aes(col=photo.type)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
text=element_text(family="sans")) + xlab("Latitude") + ylab("Daylength (hours)") +
guides(col=FALSE) + ggtitle("A") +
scale_colour_manual(values=c(cols, "black"),
labels=c(current = "Current",
aprojected = "Projected",
ospree = "OSPREE")) + guides(shape=FALSE, alpha=FALSE)+
scale_shape_manual(name="Data Type", values=c(16, 15, 17),
labels=c(current = "Current",
aprojected = "Projected",
ospree = "OSPREE")) +
scale_alpha_manual(name="Data Type", values=c(0.1,0.1,1),
labels=c(current = "Current",
aprojected = "Projected",
ospree = "OSPREE")) +
scale_y_continuous(limits=c(0, 25), breaks=c(0,4,8,12,16,20,24), expand=c(0,0))
doy.photo<- ggplot(qxx, aes(x=doy, y=photoperiod, col=phen.type, shape=phen.type, alpha=phen.type)) + geom_point(aes(col=phen.type)) + geom_jitter(aes(col=phen.type)) +
#geom_polygon( data=hulls.phen, alpha=.5, aes(fill=phen.type)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
legend.position = "none", legend.text = element_text(size=9), legend.title = element_text(size=10),
legend.key = element_rect(colour = NA, fill = NA), legend.box.background = element_rect(), text=element_text(family="sans")) + xlab("Day of Budburst") + ylab("Daylength (hours)") +
labs(col="Data Type") + ggtitle("B") +
scale_colour_manual(name="Data Type", values=c(cols, "black"),
labels=c(current = "Current",
aprojected = "Projected",
ospree = "OSPREE")) + guides(shape=FALSE, alpha=FALSE) +
scale_shape_manual(name="Data Type", values=c(16, 15, 17),
labels=c(current = "Current",
aprojected = "Projected",
ospree = "OSPREE")) +
scale_alpha_manual(name="Data Type", values=c(0.1,0.1,1),
labels=c(current = "Current",
aprojected = "Projected",
ospree = "OSPREE")) +
scale_y_continuous(limits=c(0, 25), breaks=c(0,4,8,12,16,20,24), expand=c(0,0))
ggarrange(geo.photo, doy.photo, ncol=2)
doy.photo<- ggplot(qxx, aes(x=doy, y=photoperiod, col=phen.type, shape=phen.type, alpha=phen.type)) + geom_point(aes(col=phen.type)) + geom_jitter(aes(col=phen.type)) +
#geom_polygon( data=hulls.phen, alpha=.5, aes(fill=phen.type)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
legend.position = c(0.82,0.85), legend.text = element_text(size=9), legend.title = element_text(size=10),
legend.key = element_rect(colour = NA, fill = NA), legend.box.background = element_rect(), text=element_text(family="sans")) + xlab("Day of Budburst") + ylab("Daylength (hours)") +
labs(col="Data Type") + ggtitle("B") +
scale_colour_manual(name="Data Type", values=c(cols, "black"),
labels=c(current = "Current",
aprojected = "Projected",
ospree = "OSPREE")) + guides(shape=FALSE, alpha=FALSE) +
scale_shape_manual(name="Data Type", values=c(16, 15, 17),
labels=c(current = "Current",
aprojected = "Projected",
ospree = "OSPREE")) +
scale_alpha_manual(name="Data Type", values=c(0.1,0.1,1),
labels=c(current = "Current",
aprojected = "Projected",
ospree = "OSPREE")) +
scale_y_continuous(limits=c(0, 25), breaks=c(0,4,8,12,16,20,24), expand=c(0,0))
ggarrange(geo.photo, doy.photo, ncol=2)
