getwd()
getwd()
# Note! We found some errors in chilling entries; all those are cleaned in clean_chilltemp.R ##
## housekeeping
rm(list=ls())
options(stringsAsFactors = FALSE)
# Set working directory:
if(length(grep("Lizzie", getwd())>0)) { setwd("~/Documents/git/projects/treegarden/budreview/ospree/analyses")
} else if
(length(grep("Ignacio", getwd()))>0) { setwd("~/GitHub/ospree/analyses")
} else if
(length(grep("ailene", getwd()))>0) {setwd("/Users/aileneettinger/git/ospree/analyses")
} else
setwd("~/Documents/git/ospree/analyses")
# Load libraries
library(dplyr)
library(tidyr)
# 1. Get the data
d <- read.csv("input/ospree.csv")
# 2. Need to deal with some basic cleaning, delete a few extraneous columns
d$X <- NULL
d$X.1 <- NULL
d$X.2 <- NULL
d$X.3 <- NULL
# 3. Clean up some super miscellaneous stuff
source("cleaning/clean_misc.R")
# 4. Clean up response variable names
source("cleaning/clean_respvar.R")
# 5. Clean up photoperiod #
source("cleaning/clean_photo.R")
# 6. Clean up forcetemp
source("cleaning/clean_forcetemp.R")
# 7. Get rid of non-woodys and clean species names
source("cleaning/clean_woody_sps.R")
# Run the below every so often (commented out because it is slow)
# This checks the species list against www.theplantlist.org ... ask for manchecksp to see non-matches
# source("cleaning/clean_spp_match.R")
# 8. Clean response and response time columns.
source("cleaning/clean_responsetime.R")
# 9. Clean the lat/long (growing and provenance)
source("cleaning/cleaning_latlong.R")
# 10. Remove duplicate lines
source("cleaning/clean_duplicates.R")
# 11. Write out the final file!
write.csv(d, "output/ospree_clean.csv", row.names=FALSE)
## housekeeping
rm(list=ls())
options(stringsAsFactors = FALSE)
# Set working directory:
if(length(grep("Lizzie", getwd())>0)) {setwd("~/Documents/git/projects/treegarden/budreview/ospree/analyses")
} else if
(length(grep("ailene", getwd()))>0) {setwd("/Users/aileneettinger/git/ospree/analyses")
}else
setwd("~/Documents/git/ospree/analyses")
# Load libraries
library(dplyr)
library(tidyr)
library(plyr)
library(ncdf4)
library(Interpol.T)
library(chillR)
# 1. Get the data
d <- read.csv("output/ospree_clean.csv")
source("chilling/cleaning_chilltemp.R")
# 4a: summarize lat/longs needed to pull climate data from europe and north america
source("chilling/fieldchillcalc_latlong.R")
climatedrive = "/Volumes/climate" #Ailene's climate data drive
# 4c. pull climate data from europe
source("chilling/pullclimate_eur.R")
# 4d: pull climate data from north america
#tempval <- list() #required to just pull nam climate
source("chilling/pullclimate_nam.R")
# 4e: Interpolate hourly temperatures from the daily values
# & chilling using three different metrics
#(If you want to avoid connecting to the external hard drive, then start here)
#load this .RData workspace)
#load("output/fieldclimate.RData")
source("chilling/interpolclimate.R")
source("chilling/totalchillcalc.R")
write.csv(dat4, "output/ospree_clean_withchill.csv", row.names=FALSE) ##
dim(dat4)
colnames(dat4)
#check some things on this fil
#dim(dat4)#12743    79
dat4[dat4$datasetID=="heide93" & dat4$genus=="Corylus",]
#check some things on this fil
#dim(dat4)#12743    79
dat4$chilldays[dat4$datasetID=="heide93" & dat4$genus=="Corylus",]
#check some things on this fil
#dim(dat4)#12743    79
dat4$chilldays[dat4$datasetID=="heide93" & dat4$genus=="Corylus"]
#check some things on this fil
#dim(dat4)#12743    79
dat4$chilldays[dat4$datasetID=="li05"]
#check some things on this fil
#dim(dat4)#12743    79
dat4[dat4$datasetID=="li05",]
# chilling is calculated by multiplying chilldays and chilltemp together.
#however, if chilldays=0, sometimes chilltemp is listed as NA, yielding experimental chilling of NA when it should be 0.
dat4$chilldays[which(dat4$chilldays=="")]
length(dat4$chilldays[which(dat4$chilldays=="")])
lenght(dat4$chilldays)
length(dat4$chilldays)
dat4<-join(dat3, chillcalcs,by="ID_fieldsample.date2",match="all")
#We realized that some sites have included chilling estimates (rather than chiltemp and chillhours). Here we add those studies in:
#unique(dat4$cu.model)
#Four studies have field chilling reported with the utah model: "biasi12"    "cook00b"    "heide93"    "skuterud94"
dat4$Field_Utah_Model[dat4$cu.model=="Utah"|dat4$cu.model=="Utah model"]<-dat4$field.chill.units[dat4$cu.model=="Utah"|dat4$cu.model=="Utah model"]#149 rows
# chilling is calculated by multiplying chilldays and chilltemp together.
#however, if chilldays=0, sometimes chilltemp is listed as NA, yielding experimental chilling of NA when it should be 0.
dat4$chilldays[which(dat4$chilldays=="")]<-0 #no chilling for these
dat4$chilldays[which(dat4$datasetID=="falusi90" & dat4$chilldays=="")] <-0 #no chilling for these
dat4$chilldays[which(dat4$datasetID=="falusi96" & dat4$study=="exp2"& dat4$fieldchill=="no")] <-0  ## No chilling. would fix 44 rows
dat4$chilldays[which(d$datasetID=="falusi96" & dat4$study=="exp3"& dat4$fieldchill=="no")] <-0    ##would fix 52 rows
###li05 short day controls got no chilling
dat4$chilldays[which(dat4$datasetID=="li05" & dat4$other.treatment=="short day controls")] <- 0
dat4$Exp_Chilling_Hours[which(dat4$chilldays=="0")]<-0
dat4$Exp_Utah_Model[which(dat4$chilldays=="0")]<-0
dat4$Exp_Chill_portions[which(dat4$chilldays=="0")]<-0
### Now add column for total chilling (field plus experimental)
### First, total chilling = exp and field
dat4$Total_Chilling_Hours <- dat4$Exp_Chilling_Hours+dat4$Field_Chilling_Hours
dat4$Total_Utah_Model <- dat4$Exp_Utah_Model+dat4$Field_Utah_Model
dat4$Total_Chill_portions <- dat4$Exp_Chill_portions+dat4$Field_Chill_portions
#For sites with no experimental chilling, just use field chilling:
dat4[which(is.na(dat4$Exp_Chilling_Hours)),]$Total_Chilling_Hours<-dat4[which(is.na(dat4$Exp_Chilling_Hours)),]$Field_Chilling_Hours
dat4[which(is.na(dat4$Exp_Utah_Model)),]$Total_Utah_Model<-dat4[which(is.na(dat4$Exp_Utah_Model)),]$Field_Utah_Model
dat4[which(is.na(dat4$Exp_Chill_portions)),]$Total_Chill_portions<-dat4[which(is.na(dat4$Exp_Chill_portions)),]$Field_Chill_portions
#For sites with no field chilling, should we use only experimental chilling? not sure if this is ok...
dat4[which(is.na(dat4$Field_Chilling_Hours)),]$Total_Chilling_Hours<-dat4[which(is.na(dat4$Field_Chilling_Hours)),]$Exp_Chilling_Hours
dat4[which(is.na(dat4$Field_Utah_Model)),]$Total_Utah_Model<-dat4[which(is.na(dat4$Field_Utah_Model)),]$Exp_Utah_Model
dat4[which(is.na(dat4$Field_Chill_portions)),]$Total_Chill_portions<-dat4[which(is.na(dat4$Field_Chill_portions)),]$Exp_Chill_portions
#check
#length(dat4$Total_Utah_Model[which(dat4$chilldays=="0")])
stop("Not an error, just stopping here to say we're now done totalling up field and experimental chilling. Yay!")
unique(dat4$datasetID[which(is.na(dat4$Total_Utah_Model))])
length(dat4$Total_Utah_Model[which(dat4$chilldays=="0")])
dim(dat4)#12743
#check some things on this fil
#dim(dat4)#12743    79
dat4$chilldays[dat4$datasetID=="heide93" & dat4$genus=="Corylus"]
dat4$missingCH<-0
dat4$missingCH[which(is.na(dat4$Total_Chilling_Hours))]<-1
chilltab<-table(dat4$datasetID,dat4$missingCH)
missing<-chilltab[chilltab[,2]>0,]
missing
dat4<-join(dat3, chillcalcs,by="ID_fieldsample.date2",match="all")
#We realized that some sites have included chilling estimates (rather than chiltemp and chillhours). Here we add those studies in:
#unique(dat4$cu.model)
#Four studies have field chilling reported with the utah model: "biasi12"    "cook00b"    "heide93"    "skuterud94"
dat4$Field_Utah_Model[dat4$cu.model=="Utah"|dat4$cu.model=="Utah model"]<-dat4$field.chill.units[dat4$cu.model=="Utah"|dat4$cu.model=="Utah model"]#149 rows
dat4$chilltemp[which(dat4$chilldays==0)]
dat4$chilltemp[which(dat4$chilldays==0 & which(dat4$chilltemp=="")]
dat4$chilltemp[which(dat4$chilldays==0 & dat4$chilltemp=="")]
dat4$datasetID[which(dat4$chilldays==0 & dat4$chilltemp=="")]
# chilling is calculated by multiplying chilldays and chilltemp together.
#however, if chilldays=0, sometimes chilltemp is listed as NA, yielding experimental chilling of NA when it should be 0.
dat4$chilltemp[which(dat4$chilldays==0 & dat4$chilltemp=="")]<-0
dat4$chilldays[which(dat4$datasetID=="falusi90" & dat4$chilldays=="")] <-0 #no chilling for these
dat4$chilldays[which(dat4$datasetID=="falusi96" & dat4$study=="exp2"& dat4$fieldchill=="no")] <-0  ## No chilling. would fix 44 rows
dat4$chilldays[which(d$datasetID=="falusi96" & dat4$study=="exp3"& dat4$fieldchill=="no")] <-0    ##would fix 52 rows
###li05 short day controls got no chilling
dat4$chilldays[which(dat4$datasetID=="li05" & dat4$other.treatment=="short day controls")] <- 0
dat4$Exp_Chilling_Hours[which(dat4$chilldays=="0")]<-0
dat4$Exp_Utah_Model[which(dat4$chilldays=="0")]<-0
dat4$Exp_Chill_portions[which(dat4$chilldays=="0")]<-0
### Now add column for total chilling (field plus experimental)
### First, total chilling = exp and field
dat4$Total_Chilling_Hours <- dat4$Exp_Chilling_Hours+dat4$Field_Chilling_Hours
dat4$Total_Utah_Model <- dat4$Exp_Utah_Model+dat4$Field_Utah_Model
dat4$Total_Chill_portions <- dat4$Exp_Chill_portions+dat4$Field_Chill_portions
#For sites with no experimental chilling, just use field chilling:
dat4[which(is.na(dat4$Exp_Chilling_Hours)),]$Total_Chilling_Hours<-dat4[which(is.na(dat4$Exp_Chilling_Hours)),]$Field_Chilling_Hours
dat4[which(is.na(dat4$Exp_Utah_Model)),]$Total_Utah_Model<-dat4[which(is.na(dat4$Exp_Utah_Model)),]$Field_Utah_Model
dat4[which(is.na(dat4$Exp_Chill_portions)),]$Total_Chill_portions<-dat4[which(is.na(dat4$Exp_Chill_portions)),]$Field_Chill_portions
#For sites with no field chilling, should we use only experimental chilling? not sure if this is ok...
dat4[which(is.na(dat4$Field_Chilling_Hours)),]$Total_Chilling_Hours<-dat4[which(is.na(dat4$Field_Chilling_Hours)),]$Exp_Chilling_Hours
dat4[which(is.na(dat4$Field_Utah_Model)),]$Total_Utah_Model<-dat4[which(is.na(dat4$Field_Utah_Model)),]$Exp_Utah_Model
dat4[which(is.na(dat4$Field_Chill_portions)),]$Total_Chill_portions<-dat4[which(is.na(dat4$Field_Chill_portions)),]$Exp_Chill_portions
unique(dat4$datasetID[which(is.na(dat4$Total_Utah_Model))])
dat4$missingCH<-0
dat4$missingCH[which(is.na(dat4$Total_Chilling_Hours))]<-1
chilltab<-table(dat4$datasetID,dat4$missingCH)
missing<-chilltab[chilltab[,2]>0,]
missing
chilltab
head(chillcalcs)
head(chillcalcs[chillcalcs$datasetIDlatlong=="heide93_40.8092_10.767_1991-01-15_0",])
chillcalcs <- read.csv("output/fieldchillcalcslatlong.csv", header=T)
#Add field chilling calculations
###if you don't have climate data, read in chillcalc file,
#chillcalcs <- read.csv("output/fieldchillcalcslatlong.csv", header=T)
chillcalcs <- chillcalcs[apply(chillcalcs, 1, function(x) all(!is.na(x))),] # only keep rows of all not NA.dim: 235   6
chillcalcs
colnames(chillcalcs) <- c("ID_fieldsample.date2","Season","End_year","Field_Chilling_Hours","Field_Utah_Model","Field_Chill_portions")
chillcalcs <- chillcalcs[chillcalcs$ID_fieldsample.date2 %in% dat3$ID_fieldsample.date2,]
#found 2 duplicate chilling calculation for laube14a: laube14a_48.403008_11.711811_2012-01-30_0 and laube14a_48.403008_11.711811_2012-03-14_0. For some reason, there are 2 years listed for this one- 2010/2011 and 2011/2012. since field sample date was january 2012, it should just be te 2011-2012 season. Remove
chillcalcs<-chillcalcs[-which(chillcalcs$ID_fieldsample.date2=="laube14a_48.403008_11.711811_2012-01-30_0" & chillcalcs$End_year==2011),]
chillcalcs<-chillcalcs[which(chillcalcs$ID_fieldsample.date2=="laube14a_48.403008_11.711811_2012-03-14_0" & chillcalcs$End_year==2011),]
#Add field chilling calculations
###if you don't have climate data, read in chillcalc file,
chillcalcs <- read.csv("output/fieldchillcalcslatlong.csv", header=T)
chillcalcs <- chillcalcs[apply(chillcalcs, 1, function(x) all(!is.na(x))),] # only keep rows of all not NA.dim: 235   6
colnames(chillcalcs) <- c("ID_fieldsample.date2","Season","End_year","Field_Chilling_Hours","Field_Utah_Model","Field_Chill_portions")
chillcalcs[which(chillcalcs$ID_fieldsample.date2=="laube14a_48.403008_11.711811_2012-03-14_0" & chillcalcs$End_year==2011),]
chillcalcs[which(chillcalcs$ID_fieldsample.date2=="laube14a_48.403008_11.711811_2012-01-30_0" & chillcalcs$End_year==2011),]
#Add field chilling calculations
###if you don't have climate data, read in chillcalc file,
chillcalcs <- read.csv("output/fieldchillcalcslatlong.csv", header=T)
chillcalcs <- chillcalcs[apply(chillcalcs, 1, function(x) all(!is.na(x))),] # only keep rows of all not NA.dim: 235   6
colnames(chillcalcs) <- c("ID_fieldsample.date2","Season","End_year","Field_Chilling_Hours","Field_Utah_Model","Field_Chill_portions")
chillcalcs[which(chillcalcs$ID_fieldsample.date2=="laube14a_48.403008_11.711811_2012-01-30_0"),]
chillcalcs[which(chillcalcs$ID_fieldsample.date2=="laube14a_48.403008_11.711811_2012-03-14_0"),]
#Add field chilling calculations
###if you don't have climate data, read in chillcalc file,
chillcalcs <- read.csv("output/fieldchillcalcslatlong.csv", header=T)
chillcalcs <- chillcalcs[apply(chillcalcs, 1, function(x) all(!is.na(x))),] # only keep rows of all not NA.dim: 235   6
colnames(chillcalcs) <- c("ID_fieldsample.date2","Season","End_year","Field_Chilling_Hours","Field_Utah_Model","Field_Chill_portions")
chillcalcs <- chillcalcs[chillcalcs$ID_fieldsample.date2 %in% dat3$ID_fieldsample.date2,]
dim(chillcalcs)
dim(dat3)
dat4<-join(dat3, chillcalcs,by="ID_fieldsample.date2",match="all")
dim(dat4)
unique(dat4$cu.model)
dat4$Field_Utah_Model[dat4$cu.model=="Utah"|dat4$cu.model=="Utah model"]
dat4$field.chill.units[dat4$cu.model=="Utah"|dat4$cu.model=="Utah model"]
#We realized that some sites have included chilling estimates (rather than chiltemp and chillhours). Here we add those studies in:
#unique(dat4$cu.model)
#Four studies have field chilling reported with the utah model: "biasi12"    "cook00b"    "heide93"    "skuterud94"
dat4$Field_Utah_Model[dat4$cu.model=="Utah"|dat4$cu.model=="Utah model"]<-dat4$field.chill.units[dat4$cu.model=="Utah"|dat4$cu.model=="Utah model"]#149 rows
head(chillcalcs[chillcalcs$datasetIDlatlong=="heide93_40.8092_10.767_1991-01-15_0",])
head(chillcalcs[chillcalcs$datasetIDlatlong=="sonsteby14_60.701_10.872_2010-11-03_0",])
#save the field chilling calculations in a separate file
write.csv(chillcalcs, "output/fieldchillcalcslatlong.csv", row.names=FALSE, eol="\r\n")
head(chillcalcs[chillcalcs$ID_fieldsample.date2=="heide93_40.8092_10.767_1991-01-15_0",])
head(chillcalcs[chillcalcs$ID_fieldsample.date2=="sonsteby14_60.701_10.872_2010-11-03_0",])
head(chillcalcs[chillcalcs$datasetIDlatlong=="sonsteby14_60.701_10.872_2011-10-19_0",])
head(chillcalcs[chillcalcs$datasetIDlatlong=="sonsteby14_60.701_10.872_2012-10-17_0",])
rm(list=ls())
options(stringsAsFactors = FALSE)
# Set working directory:
if(length(grep("Lizzie", getwd())>0)) {setwd("~/Documents/git/projects/treegarden/budreview/ospree/analyses")
} else if
(length(grep("ailene", getwd()))>0) {setwd("/Users/aileneettinger/git/ospree/analyses")
}else
setwd("~/Documents/git/ospree/analyses")
library(dplyr)
library(tidyr)
library(plyr)
library(ncdf4)
library(Interpol.T)
library(chillR)
# 1. Get the data
d <- read.csv("output/ospree_clean.csv")
head(chillcalcs$ID_fieldsample.date2)
source("chilling/cleaning_chilltemp.R")
# 4a: summarize lat/longs needed to pull climate data from europe and north america
source("chilling/fieldchillcalc_latlong.R")
climatedrive = "/Volumes/climate" #Ailene's climate data drive
# 4c. pull climate data from europe
source("chilling/pullclimate_eur.R")
# 4d: pull climate data from north america
#tempval <- list() #required to just pull nam climate
source("chilling/pullclimate_nam.R")
# 4e: Interpolate hourly temperatures from the daily values
# & chilling using three different metrics
#(If you want to avoid connecting to the external hard drive, then start here)
#load this .RData workspace)
#load("output/fieldclimate.RData")
source("chilling/interpolclimate.R")
head(chillcalcs)
tail(chillcalcs)
head(chillcalcs[chillcalcs$datasetIDlatlong=="heide93_40.8092_10.767_1991-01-15_0",])
unique(chillcalcs$datasetIDlatlong)
head(chillcalcs[chillcalcs$datasetIDlatlong=="heide93_59.5_10.767_1991-01-15_0",])
head(chillcalcs[chillcalcs$datasetIDlatlong=="sonsteby14_60.701_10.872_2010-11-03_0",])
head(chillcalcs[chillcalcs$datasetIDlatlong=="sonsteby14_60.701_10.872_2011-10-19_0",])
head(chillcalcs[chillcalcs$datasetIDlatlong=="sonsteby14_60.701_10.872_2012-10-17_0",])
tempval$`sonsteby14_60.701_10.872_2012-10-17_0`
head(chillcalcs[chillcalcs$datasetIDlatlong=="sonsteby14_60.701_10.872_2012-10-17_0",])
#Check to see if any problems from "imput_chilling.R" are solved:
#head(chillcalcs)
#head(chillcalcs[chillcalcs$datasetIDlatlong=="heide93_59.5_10.767_1991-01-15_0",])
#head(chillcalcs[chillcalcs$datasetIDlatlong=="sonsteby14_60.701_10.872_2010-11-03_0",])
#head(chillcalcs[chillcalcs$datasetIDlatlong=="sonsteby14_60.701_10.872_2011-10-19_0",])
#head(chillcalcs[chillcalcs$datasetIDlatlong=="sonsteby14_60.701_10.872_2012-10-17_0",])
#head(chillcalcs[chillcalcs$datasetIDlatlong=="sonsteby14_60.701_10.872_2012-10-17_0",])
head(chillcalcs[chillcalcs$datasetIDlatlong=="falusi96_42.05_14.02_1988-04-30_0",])
source("chilling/totalchillcalc.R")
#check some things from imput_chilling
dat4[which(dat4$datasetID=="falusi96" & dat$study=="exp1"),]
#check some things from imput_chilling
dat4[which(dat4$datasetID=="falusi96" & dat4$study=="exp1"),]
#check some things from imput_chilling
tail(dat4[which(dat4$datasetID=="falusi96" & dat4$study=="exp1"),])
dat4$[which(dat4$datasetID=="falusi96" & dat4$study=="exp2"& dat4$fieldchill=="yes"),]
dat4[which(dat4$datasetID=="falusi96" & dat4$study=="exp2"& dat4$fieldchill=="yes"),]
d$chilldays[which(d$datasetID=="falusi96" & d$study=="exp2"& d$fieldchill=="no")]
#check some things from imput_chilling
# tail(dat4[which(dat4$datasetID=="falusi96" & dat4$study=="exp1"),])
#head(dat4[which(dat4$datasetID=="falusi96" & dat4$study=="exp2"& dat4$fieldchill=="yes"),])  ###would fix 80 entries
d$TotalChillingHours[which(d$datasetID=="falusi96" & d$study=="exp2"& d$fieldchill=="no")]
colnames(dat4)
#check some things from imput_chilling
# tail(dat4[which(dat4$datasetID=="falusi96" & dat4$study=="exp1"),])
#head(dat4[which(dat4$datasetID=="falusi96" & dat4$study=="exp2"& dat4$fieldchill=="yes"),])  ###would fix 80 entries
dat4$Total_Utah_Model[which(dat4$datasetID=="falusi96" & dat4$study=="exp2"& dat4$fieldchill=="no")]
#No chilling. would fix 44 rows
#exp3
dat4$Total_Utah_Model[which(dat4$datasetID=="falusi96" & dat4$study=="exp3"& dat4$fieldchill=="yes")##would fix 84 rows
#No chilling. would fix 44 rows
#exp3
dat4$Total_Utah_Model[which(dat4$datasetID=="falusi96" & dat4$study=="exp3"& dat4$fieldchill=="yes")]##would fix 84 rows
#check some things from imput_chilling
# tail(dat4[which(dat4$datasetID=="falusi96" & dat4$study=="exp1"),])
#head(dat4[which(dat4$datasetID=="falusi96" & dat4$study=="exp2"& dat4$fieldchill=="yes"),])  ###would fix 80 entries
#dat4$Total_Utah_Model[which(dat4$datasetID=="falusi96" & dat4$study=="exp2"& dat4$fieldchill=="no")]
#No chilling. would fix 44 rows
#exp3
#dat4$Total_Utah_Model[which(dat4$datasetID=="falusi96" & dat4$study=="exp3"& dat4$fieldchill=="yes")]##would fix 84 rows
dat4$Total_Utah_Model[which(dat4$datasetID=="falusi96" & dat4$study=="exp3"& dat4$fieldchill=="no")] ##would fix 52 rows DOne in totall.chilling.R
source("chilling/totalchillcalc.R")
tail(dat4[which(dat4$datasetID=="falusi96" & dat4$study=="exp1"),])
head(dat4[which(dat4$datasetID=="falusi96" & dat4$study=="exp2"& dat4$fieldchill=="yes"),])  ###would fix 80
dat4$Total_Utah_Model[which(dat4$datasetID=="falusi96" & dat4$study=="exp2"& dat4$fieldchill=="no")]
dat4$Total_Utah_Model[which(dat4$datasetID=="falusi96" & dat4$study=="exp3"& dat4$fieldchill=="yes")]##would fix 84 rows
dat4$Total_Utah_Model[which(dat4$datasetID=="falusi96" & dat4$study=="exp3"& dat4$fieldchill=="no")] ##would fix 52 rows DOne in totall.chilling.R
write.csv(dat4, "output/ospree_clean_withchill.csv", row.names=FALSE) ##
dim(dat4)#12743    7
#check some things on this fil
#dim(dat4)#12743    79
dat4$chilldays[dat4$datasetID=="heide93" & dat4$genus=="Corylus"]
#check some things on this fil
#dim(dat4)#12743    79
dat4$Total_Utah_Model[dat4$datasetID=="heide93" & dat4$genus=="Corylus"]
dat4$missingCH<-0
dat4$missingCH[which(is.na(dat4$Total_Chilling_Hours))]<-1
#chilltab<-table(dat4$datasetID,dat4$missingCH)
missing<-chilltab[chilltab[,2]>0,]
chilltab<-table(dat4$datasetID,dat4$missingCH)
missing<-chilltab[chilltab[,2]>0,]
missing
dat4$chilltemp[which(dat4$datasetID=="sogaard08" & dat4$study=="exp3b")]
